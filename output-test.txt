#INFO: **** input file is /Users/jaydenl/Dev/ASDRP/QCHEM/PySCF-UI/stream.py ****
import streamlit as st
import streamlit.components.v1 as components
from pyscf import gto, scf
from streamlit.runtime.scriptrunner import add_script_run_ctx
import threading
import time
from stmol import *
import py3Dmol
from rdkit import Chem
from rdkit.Chem import rdDetermineBonds
from rdkit.Chem.rdmolfiles import MolFromXYZFile
from rdkit.Chem import Descriptors
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from collections import defaultdict
import altair as alt
import os

if 'queue' not in st.session_state:
    st.session_state['queue'] = []
if 'results' not in st.session_state:
    st.session_state['results'] = []
if 'computing' not in st.session_state:
    st.session_state['computing'] = False
    
# get all files in directory names precomputed_molecules:
precomputed_molecules = list(map(lambda x: x.split(".")[0], os.listdir("precomputed_molecules")))


def compute_pyscf(atom, basis_option, verbose_option):
    # print(atom)
    # print(basis_option)
    # print(verbose_option)
    mol = gto.Mole()
    mol.atom = atom
    mol.basis = basis_option
    mol.verbose = int(verbose_option[0])
    mol.output = 'output-test.txt'
    mol.build()

    mf = scf.RHF(mol)
    mf.kernel()
    outputFile = open("output-test.txt", "r")
    # Extract energy and time information
    time = None
    energy = None
    for line in outputFile.readlines():
        if line.startswith("    CPU time for SCF"):
            time = float(line.split(" ")[-2])

        elif line.startswith("converged SCF energy = "):
            energy = float(line.split(" ")[-1])
    return energy, time


def getMoleculeName(atom):
    d = {}
    for line in atom.split("\n"):
        try:
            name = line.split()[0]
            if name in d:
                d[name] += 1
            else:
                d[name] = 1
        except:
            pass
    name = ""
    for key in d:
        name += key + str(d[key])
    return name


# Streamlit layout
st.title("PySCF")

# Function to process the uploaded text file


def process_text_file(uploaded_file):
    if uploaded_file is not None:
        # Read the contents of the file
        text_contents = uploaded_file.getvalue().decode("utf-8")
        return text_contents
    else:
        return None
    
def addToQueue(atom):
    st.session_state['queue'].append(atom)

tabDatabase, tabTextInput, tabFileInput = st.tabs(["Database", "Text Input", "File Input"])
with tabDatabase:
    selectedMolecule = st.selectbox('Search Molecule Database', precomputed_molecules)
    if st.button('Add to Queue', use_container_width=True, key="db"):
        if selectedMolecule:
            parseDatafile = open("precomputed_molecules/" + selectedMolecule + ".geom.txt", "r").readlines()[4:]
            parseDatafile = "\n".join(parseDatafile[:-1])
            addToQueue(parseDatafile)
        else:
            st.warning(
                "Please select a molecule using dropdown menu or inputting a text file.")
    
with tabTextInput:
    # Create a Streamlit button which gives example
    with st.expander("See Example Input"):
        st.write("C 0.0000000 0.0000000 0.0000000")
        st.write("H 0.6311940 0.6311940 0.6311940")
        st.write("H -0.6311940 -0.6311940 0.6311940")
        st.write("H -0.6311940 0.6311940 -0.6311940")
        st.write("H 0.6311940 -0.6311940 -0.631194")
    # Fills xyz_input text area to the contents of the uploaded file
    xyz_input = st.text_area("XYZ Input", key="textxyz")
    
    if st.button('Add to Queue', use_container_width=True, key="text"):
        if xyz_input:
            addToQueue(xyz_input)
        else:
            st.warning(
                "Please provide an XYZ input using the text box or inputting a text file.")

with tabFileInput:
    # Create a Streamlit button which gives example
    with st.expander("See Example Input"):
        st.write("C 0.0000000 0.0000000 0.0000000")
        st.write("H 0.6311940 0.6311940 0.6311940")
        st.write("H -0.6311940 -0.6311940 0.6311940")
        st.write("H -0.6311940 0.6311940 -0.6311940")
        st.write("H 0.6311940 -0.6311940 -0.631194")
    # Display file uploader for a single text file and processes it
    uploaded_file = st.file_uploader("Upload a XYZ input", type=["txt"])
    text_contents = process_text_file(uploaded_file)
    xyz_input = st.text_area(
        "XYZ Input", value=text_contents, key="filexyz") if text_contents else None
    if st.button('Add to Queue', use_container_width=True, key="filequeue"):
        if text_contents:
            addToQueue(text_contents)
        else:
            st.warning(
                "Please provide an XYZ input using file uploader")


basis_option = st.selectbox("Basis", ["cc-pVTZ", "asdf"])
verbose_option = st.selectbox("Verbose", index=2, options=[
                              "3, energy only", "4, cycles and energy", "5, cycles energy and runtime", "9, max"])

col1, col2, col3, col4 = st.columns(4, gap="small")

# if col1.button("Add to Queue"):
#     if xyz_input:
#         addToQueue(xyz_input)
#     else:
#         st.warning(
#             "Please provide an XYZ input using the text box or inputting a text file.")

# Computes only if something is added to the queue; grayed out otherwise
compute_disabled = len(st.session_state['queue']) == 0
if st.button("Compute", disabled=compute_disabled, type="primary", use_container_width=True) or st.session_state['computing'] == True:
    if len(st.session_state['queue']) > 0:
        with st.spinner("Computing " + getMoleculeName(st.session_state['queue'][0]) + "..."):
            st.session_state['computing'] = True
            atom = st.session_state['queue'][0]
            st.session_state['queue'].pop(0)
            # st.write("Computing...")
            # progress_text = "Computing..."
            # my_bar = st.progress(0, text=progress_text)

            # for percent_complete in range(100):
            #     time.sleep(0.01)
            #     my_bar.progress(percent_complete + 1, text=progress_text)
            # time.sleep(1)
            # my_bar.empty()
            
            # Delete empty lines
            parsed = [line for line in atom.splitlines() if line.strip() != ""]
            xyz = "\n".join(parsed)
            mol = f"{len(parsed)}\nname\n{str(xyz)}"
            
            # output xyz into molecule.xyz file
            with open('molecule.xyz', 'w') as f:
                f.write(f"{len(parsed)}\nhi\n{str(xyz)}")
                
            raw_mol = MolFromXYZFile('molecule.xyz')
            rdkit_mol = Chem.Mol(raw_mol)
            rdDetermineBonds.DetermineBonds(rdkit_mol, charge=0)
                
            
            energy, time_val = compute_pyscf(
                atom, basis_option, verbose_option)
            molecule_name = getMoleculeName(atom)
            st.session_state['results'].append(
                (molecule_name, energy, time_val, mol, rdkit_mol))
            st.rerun()
    elif st.session_state['computing'] == True:
        st.session_state['computing'] = False
    else:
        st.warning("Please add an XYZ input to the queue.")

if 'queue' in st.session_state:
    st.subheader("Queue")
    for queue_item in st.session_state['queue']:
        st.write(getMoleculeName(queue_item))
        

tab1, tab2, tab3 = st.tabs(['Results', 'View Graphs', 'View Logs'])
        
with tab1:
    if 'results' in st.session_state:
        st.subheader("Results")
        for result_item in st.session_state['results']:
            with st.container():
                mol = result_item[4]
                result_col_1, result_col_2 = st.columns([2,1])
                result_col_1.write(
                    f"{result_item[0]} | Energy: {result_item[1]} | Time: {result_item[2]} seconds")
                result_col_1.write(
                    f"\# of Atoms: {mol.GetNumAtoms()} | \# of Bonds: {mol.GetNumBonds()} | \# of Rings:  {mol.GetRingInfo().NumRings()}")
                result_col_1.write(f"Molecular Weight: {Descriptors.MolWt(mol)}")
    
                with result_col_2:
                    speck_plot(result_item[3], component_h=200, component_w=200, wbox_height="auto", wbox_width="auto")

with tab2:
    def count_atoms(m):
        atomic_count = defaultdict(lambda : 0)
        for atom in m.GetAtoms():
            atomic_count[atom.GetAtomicNum()] += 1
        return atomic_count
            
    if 'results' in st.session_state and len(st.session_state['results']) > 1:
        st.subheader("Comparative Graphs")
        
        atom_counts = [count_atoms(result_item[4]) for result_item in st.session_state['results']]
        
        # Prepare datasets
        num_atoms = [result_item[4].GetNumAtoms() for result_item in st.session_state['results']]
        num_bonds = [result_item[4].GetNumBonds() for result_item in st.session_state['results']]
        num_conformers = [result_item[4].GetNumConformers() for result_item in st.session_state['results']]
        # 6 and 1 are atomic code
        num_carbons = [atom_counts[i][6] for i in range(len(atom_counts))]
        num_hydrogens = [atom_counts[i][1] for i in range(len(atom_counts))]
        
        energies = [result_item[1] for result_item in st.session_state['results']]
        runtimes = [result_item[2] for result_item in st.session_state['results']]

        df_atoms = pd.DataFrame({'Atoms': num_atoms, 'Energy': energies, 'Runtime': runtimes})
        df_bonds = pd.DataFrame({'Bonds': num_bonds, 'Energy': energies, 'Runtime': runtimes})
        df_conformers = pd.DataFrame({'Conformers': num_conformers, 'Energy': energies, 'Runtime': runtimes})
        df_carbons = pd.DataFrame({'Carbons': num_carbons, 'Energy': energies, 'Runtime': runtimes})
        df_hydrogens = pd.DataFrame({'Hydrogens': num_hydrogens, 'Energy': energies, 'Runtime': runtimes})
        

        # Generate Graphs  
        for df, label in zip([df_atoms, df_bonds, df_carbons, df_hydrogens], ['Atoms', 'Bonds', 'Carbons', 'Hydrogens']):
            for target in ['Energy', 'Runtime']:
                st.markdown(f'### Number of {label} vs. {target}')

                # Linear Regression
                coeffs_linear = np.polyfit(df[label].values, df[target].values, 1)
                poly1d_fn_linear = np.poly1d(coeffs_linear)
                x = np.linspace(min(df[label]), max(df[label]), 100)
                
                # Quadratic Regression
                coeffs_quad = np.polyfit(df[label].values, df[target].values, 2)
                poly1d_fn_quad = np.poly1d(coeffs_quad)
                
                # Display Equations
                st.markdown(f"<span style='color: red;'>Best Fit Linear Equation ({target}): Y = {coeffs_linear[0]:.4f}x + {coeffs_linear[1]:.4f}</span>", unsafe_allow_html=True)
                st.markdown(f"<span style='color: green;'>Best Fit Quadratic Equation ({target}): Y = {coeffs_quad[0]:.4f}x² + {coeffs_quad[1]:.4f}x + {coeffs_quad[2]:.4f}</span>", unsafe_allow_html=True)

                # Create a DataFrame for the regression lines
                df_line = pd.DataFrame({label: x, 'Linear': poly1d_fn_linear(x), 'Quadratic': poly1d_fn_quad(x)})

                # Plot
                scatter = alt.Chart(df).mark_circle(size=60).encode(
                    x=label,
                    y=target,
                    tooltip=[label, target]
                )

                line_linear = alt.Chart(df_line).mark_line(color='red').encode(
                    x=label,
                    y='Linear'
                )

                line_quad = alt.Chart(df_line).mark_line(color='green').encode(
                    x=label,
                    y='Quadratic'
                )

                # Display the plot
                st.altair_chart(scatter + line_linear + line_quad, use_container_width=True)
 
            # Display Equation
            # st.write(f"Best Fit Equation ({target}): Y = {coeffs[0]:.4f}x + {coeffs[1]:.4f}")

with tab3:
    with open('output-test.txt', 'r') as file:
        log_data = file.read()
        st.markdown(f'```\n{log_data}\n```')

        
# xyzview = py3Dmol.view(query='pdb:1A2C') 
# xyzview.setStyle({'cartoon':{'color':'spectrum'}})
# showmol(xyzview, height = 500,width=800)

# def draw_with_spheres(mol):
#     v = py3Dmol.view(width=300,height=300)
#     IPythonConsole.addMolToView(mol,v)
#     v.zoomTo()
#     v.setStyle({'sphere':{'radius':0.3},'stick':{'radius':0.2}});
#     v.show()


# Attempt at creating an async queue, need to find a way to detect browser closing to stop the queue

# def runQueue():
#     for i in range(1, 10):
#         time.sleep(1)
#         print("test", str(i))


# if 'queue-running' not in st.session_state:
#     st.session_state['queue-running'] = True
#     t = threading.Thread(target=runQueue)
#     add_script_run_ctx(t)
#     t.start()

# components.html("""<html>
# <script>
#     const origClose = window.close;
#     window.close = () => {
#         console.log("asdf");
#         // origClose();
#     }
#     document.addEventListener("beforeunload", () => {
#                 alert(1);
#                 console.log(a.a.a.a);
#     })
# </script>
# <div style="color: white" onclick="">
#                 hihihihi
# </div>
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='jaydens-macbook.lan', release='23.0.0', version='Darwin Kernel Version 23.0.0: Fri Sep 15 14:41:34 PDT 2023; root:xnu-10002.1.13~1/RELEASE_ARM64_T8103', machine='arm64', processor='arm')  Threads 1
Python 3.8.18 | packaged by conda-forge | (default, Oct 10 2023, 15:46:56) 
[Clang 16.0.6 ]
numpy 1.24.4  scipy 1.10.1
Date: Mon Jan 22 18:36:34 2024
PySCF version 2.4.0
PySCF path  /Users/jaydenl/anaconda3/envs/pyscfui/lib/python3.8/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 14
[INPUT] num. electrons = 34
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -0.419812000000   0.637210000000   0.000000000000 AA   -0.793329703806   1.204152383834   0.000000000000 Bohr   0.0
[INPUT]  2 C      0.419812000000  -0.637210000000   0.000000000000 AA    0.793329703806  -1.204152383834   0.000000000000 Bohr   0.0
[INPUT]  3 C      0.419812000000   1.910270000000   0.000000000000 AA    0.793329703806   3.609887123973   0.000000000000 Bohr   0.0
[INPUT]  4 C     -0.419812000000  -1.910270000000   0.000000000000 AA   -0.793329703806  -3.609887123973   0.000000000000 Bohr   0.0
[INPUT]  5 H     -1.072151000000   0.635490000000   0.869201000000 AA   -2.026071754179   1.200902054900   1.642551837198 Bohr   0.0
[INPUT]  6 H     -1.072151000000   0.635490000000  -0.869201000000 AA   -2.026071754179   1.200902054900  -1.642551837198 Bohr   0.0
[INPUT]  7 H      1.072151000000  -0.635490000000   0.869201000000 AA    2.026071754179  -1.200902054900   1.642551837198 Bohr   0.0
[INPUT]  8 H      1.072151000000  -0.635490000000  -0.869201000000 AA    2.026071754179  -1.200902054900  -1.642551837198 Bohr   0.0
[INPUT]  9 H     -0.206569000000   2.794983000000   0.000000000000 AA   -0.390358835825   5.281752392815   0.000000000000 Bohr   0.0
[INPUT] 10 H      1.058531000000   1.957536000000   0.875807000000 AA    2.000333684362   3.699206918977   1.655035367977 Bohr   0.0
[INPUT] 11 H      1.058531000000   1.957536000000  -0.875807000000 AA    2.000333684362   3.699206918977  -1.655035367977 Bohr   0.0
[INPUT] 12 H      0.206569000000  -2.794983000000   0.000000000000 AA    0.390358835825  -5.281752392815   0.000000000000 Bohr   0.0
[INPUT] 13 H     -1.058531000000  -1.957536000000   0.875807000000 AA   -2.000333684362  -3.699206918977   1.655035367977 Bohr   0.0
[INPUT] 14 H     -1.058531000000  -1.957536000000  -0.875807000000 AA   -2.000333684362  -3.699206918977  -1.655035367977 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] C
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1

nuclear repulsion = 131.068064050255
number of shells = 96
number of NR pGTOs = 328
number of NR cGTOs = 260
basis = cc-pVTZ
ecp = {}
CPU time:        66.29


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/_x/xd2ms3z958s6pfllwphw48vm0000gn/T/tmpgr_g34bv
max_memory 4000 MB (current use 0 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
    CPU time for init_direct_scf      0.07 sec, wall time      0.01 sec
    CPU time for vj and vk     10.69 sec, wall time      9.59 sec
E1 = -467.4308402365644  E_coul = 178.50083860679993
init E= -157.861937579509
cond(S) = 14711.564407906535
    CPU time for initialize scf     15.29 sec, wall time     10.27 sec
  HOMO = -0.347482856952083  LUMO = 0.0975690115556491
  mo_energy =
[-11.3227248  -11.32210302 -11.31722724 -11.31467494  -1.55746781
  -1.32075321  -1.0474024   -0.90287804  -0.62424366  -0.53574275
  -0.52391425  -0.50922585  -0.42927137  -0.39906526  -0.37029948
  -0.35206242  -0.34748286   0.09756901   0.1132717    0.14552516
   0.14967288   0.17646961   0.18920778   0.20422883   0.20720345
   0.21858283   0.22803972   0.26559508   0.27784074   0.30487963
   0.35257185   0.36733236   0.38904381   0.39256028   0.39645357
   0.42073187   0.45763984   0.51673901   0.52462514   0.52905845
   0.53343913   0.55375681   0.56341926   0.57604889   0.57988064
   0.58475253   0.58826316   0.59519008   0.59559313   0.60651411
   0.62964703   0.63916183   0.71009069   0.76531167   0.77609807
   0.83700153   0.87859971   0.89018961   0.90028095   0.90897956
   0.93031328   0.97929918   1.00654176   1.02357144   1.05397892
   1.08370042   1.1342684    1.14024234   1.15108455   1.18957985
   1.20135665   1.22698799   1.22948235   1.25388219   1.25439422
   1.26063705   1.27855874   1.32578296   1.33905252   1.35436918
   1.35467886   1.3613012    1.36391084   1.36748802   1.43334653
   1.43653887   1.44174537   1.47318118   1.50600933   1.5134327
   1.5281398    1.55576467   1.56446177   1.58937803   1.59392084
   1.59687635   1.64433688   1.69283781   1.70910131   1.74583539
   1.75679239   1.76277034   1.78789517   1.83325146   1.87638036
   1.87743328   2.41428776   2.49745291   2.49785393   2.51948723
   2.54326521   2.56489527   2.60184809   2.62355998   2.67920046
   2.68915397   2.72827446   2.73201563   2.7761501    2.79168417
   2.81312037   2.82330803   2.82673049   2.89135331   2.92336868
   2.92737916   2.97012676   3.00966872   3.0234188    3.05276773
   3.05868267   3.06432405   3.08471745   3.10244667   3.13290577
   3.15211568   3.20387252   3.20467007   3.23264776   3.24902325
   3.28492694   3.28514009   3.31890369   3.32248519   3.33482574
   3.33903463   3.34310294   3.37241476   3.37571417   3.40802683
   3.43139011   3.45739476   3.46173993   3.49963655   3.5169768
   3.52243181   3.54697339   3.59310999   3.59958917   3.62407732
   3.69255696   3.69391697   3.71111779   3.71162479   3.74083241
   3.79085498   3.80399651   3.82211963   3.83488284   3.85826106
   3.87994514   3.90578929   3.91515967   3.94762302   4.0060438
   4.01110407   4.01594536   4.05000612   4.066068     4.08094551
   4.09831346   4.1052762    4.11029149   4.14555994   4.16536514
   4.17641051   4.21353024   4.23460305   4.2365344    4.24795597
   4.29559873   4.3107471    4.33372558   4.36631551   4.37678143
   4.39444971   4.4106935    4.41535375   4.41808649   4.42652308
   4.48329638   4.51444767   4.51993377   4.54084657   4.57021115
   4.58291204   4.59904956   4.61519023   4.61519804   4.67466822
   4.69106782   4.69884467   4.77625015   4.83892101   4.91818019
   4.94411062   4.95327697   4.97790534   5.01631404   5.12500031
   5.14671562   5.14763254   5.15637387   5.15921909   5.1744751
   5.23345245   5.23648712   5.28026609   5.28741185   5.29749359
   5.36904981   5.3890111    5.41809448   5.5089803    5.55236459
   5.58090906   5.64068282   5.64673972   5.66648735   5.68897728
   5.69611536   5.70803167   5.7666348    5.8010951    5.8085326
   5.81343096   5.82425907   5.85985525   5.90645308   5.95386443
   6.1874697    6.21747407   6.23492924   6.2369985    6.25778309
   6.33344017  13.13346431  13.50766974  14.08574084  14.22698608]
    CPU time for vj and vk     11.04 sec, wall time     10.02 sec
E1 = -469.66647432158175  E_coul = 181.28134697677035
cycle= 1 E= -157.317063294556  delta_E= 0.545  |g|= 0.326  |ddm|= 2.06
    CPU time for cycle= 1     11.63 sec, wall time     10.10 sec
  HOMO = -0.463735243850277  LUMO = 0.137342673803039
  mo_energy =
[-11.24354294 -11.24294    -11.2215403  -11.22153638  -1.09271311
  -1.00115787  -0.88128809  -0.80818987  -0.65307475  -0.59681692
  -0.5857766   -0.57922451  -0.52379218  -0.50455052  -0.47597738
  -0.47080141  -0.46373524   0.13734267   0.15413926   0.17440178
   0.17646621   0.20879946   0.2194533    0.22638336   0.24078676
   0.24593836   0.258634     0.3042119    0.31088119   0.35154121
   0.37652918   0.39776562   0.40554881   0.42488602   0.44228681
   0.45610502   0.50527996   0.54815633   0.55493065   0.56356811
   0.56849413   0.61285856   0.63058686   0.63451106   0.6376209
   0.6413149    0.65392155   0.6700536    0.6723824    0.67536296
   0.6952669    0.70097364   0.7465714    0.80128286   0.81682002
   0.87485116   0.90815061   0.92120967   0.93129811   0.94521696
   0.96097037   1.01198418   1.04630004   1.06925417   1.0815652
   1.11120577   1.1699768    1.17624293   1.18663772   1.22700191
   1.23773864   1.26479768   1.26603063   1.29321297   1.29771141
   1.30391906   1.32095822   1.36580618   1.37637151   1.38163878
   1.38468002   1.39870217   1.39943955   1.40780146   1.46915574
   1.48069935   1.48826764   1.51080735   1.5447953    1.54757623
   1.5662033    1.58964144   1.59817084   1.62215709   1.63548466
   1.64110975   1.68957601   1.73998555   1.74879398   1.78566653
   1.80031795   1.81903965   1.82856632   1.88888761   1.92181714
   1.93244878   2.47127629   2.55927305   2.55973129   2.57965329
   2.59792215   2.62719248   2.67018144   2.68830108   2.74296938
   2.74975648   2.78804548   2.79341094   2.84342306   2.84972643
   2.88503906   2.88851325   2.89020082   2.96347857   2.98885276
   2.99995257   3.03533425   3.07751665   3.08835513   3.12095375
   3.12702621   3.13179032   3.15071796   3.17354329   3.20345432
   3.2190324    3.27148163   3.27393401   3.303774     3.31770883
   3.35021769   3.35381605   3.38288269   3.38914767   3.4005478
   3.40645759   3.4115537    3.4359739    3.43955295   3.47420858
   3.5020028    3.51940149   3.52525228   3.55837297   3.57838977
   3.57998037   3.61227054   3.64583031   3.6526399    3.68958684
   3.74555878   3.74820578   3.76805598   3.77056962   3.79526284
   3.84857507   3.85301619   3.87210275   3.89068687   3.91093436
   3.93703593   3.96534268   3.96907576   4.00052141   4.05951353
   4.06844238   4.06911049   4.10645422   4.12533319   4.14168882
   4.15447603   4.16288117   4.16772563   4.19549846   4.21789213
   4.23010521   4.26973901   4.28781545   4.29301968   4.29678146
   4.341794     4.36094582   4.3827847    4.41821382   4.4274657
   4.43991877   4.45432107   4.45712003   4.47550505   4.48715434
   4.53649206   4.56352593   4.57085664   4.60682321   4.62200101
   4.62620163   4.65305289   4.66036833   4.67326431   4.73358959
   4.75248525   4.75393239   4.83040472   4.89763669   4.97262535
   5.00867147   5.00979453   5.04205194   5.07555637   5.18544225
   5.2060145    5.20671097   5.21272436   5.22450193   5.23357299
   5.29401609   5.29549929   5.34026012   5.34701306   5.35945064
   5.43298765   5.45983031   5.48241457   5.57701      5.62069887
   5.64630407   5.70607779   5.71365555   5.73201763   5.75454122
   5.76044464   5.7760658    5.83249754   5.86626742   5.88027223
   5.88480788   5.88966484   5.92395015   5.98242886   6.02916202
   6.26947937   6.29952541   6.31727771   6.31909415   6.33372419
   6.40988543  13.19187035  13.5701597   14.15998127  14.30155474]
    CPU time for vj and vk     11.25 sec, wall time      9.79 sec
E1 = -470.38700314366105  E_coul = 181.96588031767422
cycle= 2 E= -157.353058775732  delta_E= -0.036  |g|= 0.0858  |ddm|= 0.249
    CPU time for cycle= 2     13.72 sec, wall time     10.11 sec
  HOMO = -0.446908200461522  LUMO = 0.143874804476586
  mo_energy =
[-11.1922867  -11.19228125 -11.18916403 -11.18854303  -1.06244928
  -0.97600952  -0.85748228  -0.78371429  -0.63323691  -0.57933001
  -0.56821499  -0.56411553  -0.50949635  -0.49119913  -0.45995688
  -0.45618201  -0.4469082    0.1438748    0.16061292   0.18049445
   0.18261971   0.21461107   0.22584332   0.23150609   0.24800803
   0.25167976   0.26581324   0.31491406   0.32039814   0.36353871
   0.38388889   0.40725437   0.41173372   0.4348888    0.4578462
   0.46754151   0.51871437   0.55728011   0.5640382    0.57649641
   0.58142866   0.62648673   0.64482369   0.6466835    0.65189529
   0.65413686   0.66841774   0.68630038   0.68917037   0.69679728
   0.71558618   0.72178387   0.7597083    0.81579618   0.82687983
   0.88704666   0.91866288   0.92945718   0.94257203   0.956034
   0.97172099   1.02287781   1.0599522    1.08383154   1.0907395
   1.12112146   1.18153151   1.18943601   1.19761346   1.23872057
   1.2504056    1.27647648   1.27919167   1.30531876   1.3122751
   1.31855438   1.33427197   1.37930554   1.3879397    1.39154415
   1.39523127   1.40950794   1.41248784   1.42422641   1.48273699
   1.49510083   1.50352742   1.52397702   1.55622585   1.55895882
   1.57881352   1.60004018   1.61000786   1.63375354   1.64888766
   1.6561325    1.70382835   1.75480995   1.76183668   1.79844257
   1.81537571   1.83531094   1.84201696   1.90757865   1.93787592
   1.95194949   2.48953576   2.57871846   2.58042742   2.59946018
   2.61850385   2.65091891   2.69374763   2.71243693   2.76392723
   2.76940835   2.80834258   2.81625042   2.8670362    2.87160416
   2.91162113   2.91252007   2.91308928   2.98790004   3.01159092
   3.02755707   3.05987586   3.09854207   3.10981421   3.14286893
   3.14558531   3.15201247   3.17263999   3.19694469   3.22562783
   3.24222551   3.29267632   3.29394257   3.32603318   3.34038051
   3.37201805   3.37594371   3.40727372   3.40914682   3.42090806
   3.42845516   3.43372795   3.45852653   3.46283593   3.50097119
   3.52533684   3.54104104   3.55015319   3.57984892   3.60136277
   3.60457063   3.63294382   3.6635421    3.67029564   3.71277021
   3.76258545   3.76623736   3.78730549   3.79156506   3.81368732
   3.86825636   3.87255105   3.89114838   3.90961872   3.93032028
   3.95623929   3.98761473   3.98802205   4.01936923   4.07984636
   4.0875124    4.09015912   4.12792538   4.14669624   4.16486582
   4.17539803   4.18271434   4.19375436   4.2146682    4.23765204
   4.25029347   4.29053591   4.30794994   4.31334619   4.31516692
   4.35970619   4.37997262   4.40089132   4.43755479   4.4463616
   4.45631053   4.46997784   4.47524676   4.49644698   4.50965794
   4.55581578   4.58134297   4.59006777   4.630352     4.64073685
   4.64516019   4.67265667   4.67835083   4.69450198   4.75431962
   4.7736902    4.77665177   4.85080193   4.92011917   4.99361621
   5.03003411   5.03332833   5.0655466    5.09748658   5.20665246
   5.22528669   5.22867034   5.23284907   5.24739228   5.25528533
   5.31642894   5.31713182   5.36321147   5.3693906    5.38097491
   5.45278261   5.48586746   5.50532906   5.59907009   5.64241209
   5.66772698   5.72580905   5.73621177   5.75424422   5.774627
   5.78085895   5.79714713   5.8579982    5.88908415   5.90658472
   5.9114904    5.91247129   5.95006187   6.01054002   6.06053962
   6.29336116   6.32340223   6.3412364    6.3428359    6.36412238
   6.44130722  13.2287831   13.60898489  14.18490319  14.32540528]
    CPU time for vj and vk     10.99 sec, wall time      9.77 sec
E1 = -470.09434939512033  E_coul = 181.67054825353765
cycle= 3 E= -157.355737091328  delta_E= -0.00268  |g|= 0.0244  |ddm|= 0.0853
    CPU time for cycle= 3     12.92 sec, wall time     10.12 sec
  HOMO = -0.456880424512602  LUMO = 0.14245079971664
  mo_energy =
[-11.21314996 -11.21253421 -11.20544422 -11.20543977  -1.07180996
  -0.98245706  -0.86331822  -0.79027156  -0.64008064  -0.58577613
  -0.57518583  -0.56913159  -0.51570458  -0.49648282  -0.4689515
  -0.46286704  -0.45688042   0.1424508    0.15990173   0.17926648
   0.1811932    0.21373079   0.22489038   0.2302402    0.2469867
   0.25051818   0.26438501   0.31264557   0.31786432   0.36074564
   0.38211398   0.40488859   0.41045313   0.43158037   0.45302751
   0.46389301   0.51484803   0.5552318    0.56179428   0.57216828
   0.57730122   0.62308917   0.64045087   0.64322175   0.6491284
   0.65133076   0.66441227   0.68150017   0.68595124   0.69231467
   0.70831798   0.71449849   0.75609045   0.81182337   0.8246369
   0.88292039   0.91610876   0.92749537   0.93956833   0.95238742
   0.9689993    1.02040483   1.05565107   1.07819835   1.0895751
   1.1193517    1.17852549   1.18519576   1.19485802   1.23574095
   1.24629723   1.2731215    1.27509999   1.30214535   1.30668167
   1.31409076   1.3303678    1.37490919   1.38501304   1.38951748
   1.3928349    1.40680133   1.40848306   1.41817208   1.47831237
   1.490915     1.49818914   1.51973274   1.55304056   1.55601739
   1.57559071   1.59716196   1.6065056    1.63060458   1.64533351
   1.65128839   1.70015779   1.75120786   1.75784838   1.7948461
   1.81073762   1.83222038   1.83850809   1.90165734   1.93244181
   1.94636799   2.48582908   2.57426767   2.57447584   2.59452536
   2.61362186   2.64230407   2.68525912   2.70388861   2.75812284
   2.76451869   2.80246129   2.80907515   2.85839234   2.86431119
   2.9026492    2.90380754   2.90498207   2.9794524    3.00403681
   3.01752913   3.05129871   3.09225012   3.10293983   3.13636799
   3.14116064   3.14617452   3.16576831   3.18915252   3.2197341
   3.23451136   3.28611773   3.28800682   3.31921454   3.33306378
   3.36581333   3.36937235   3.39912899   3.40361207   3.41518462
   3.42166726   3.42700231   3.45246746   3.45559542   3.49187138
   3.51795302   3.53566633   3.54334735   3.57397591   3.59467943
   3.59698863   3.62760461   3.66186065   3.66840132   3.70579116
   3.75979383   3.76328119   3.78292419   3.78663927   3.8099377
   3.86323505   3.8685992    3.88716334   3.90547383   3.92640348
   3.95166565   3.9816861    3.98367556   4.01549973   4.07653343
   4.08453245   4.08471923   4.1237466    4.1422425    4.15926958
   4.17173588   4.17834373   4.18602037   4.21191801   4.23475066
   4.24633679   4.28631658   4.30370959   4.30910962   4.31263965
   4.35808825   4.37693143   4.39755854   4.4350353    4.44279744
   4.4546354    4.46931062   4.47186758   4.49184877   4.50399287
   4.55201426   4.57921312   4.58623268   4.62422829   4.6376371
   4.64148028   4.66928056   4.67617837   4.69051997   4.74932509
   4.7695243    4.77081456   4.84695859   4.91399256   4.9886388
   5.02565837   5.02756486   5.05815261   5.09110264   5.20203383
   5.22155954   5.22322598   5.22877874   5.24088869   5.25020028
   5.31127981   5.31258056   5.35753823   5.36461766   5.37579982
   5.44818512   5.47817335   5.49983287   5.594055     5.63799367
   5.66188481   5.7230666    5.73147516   5.74933858   5.77152102
   5.77766193   5.79340389   5.85171788   5.88340381   5.90007248
   5.90373653   5.90702278   5.94253898   6.0023259    6.05089965
   6.28867039   6.31906327   6.33682747   6.33819075   6.35589581
   6.43281726  13.21415737  13.59333958  14.17555556  14.31653741]
    CPU time for vj and vk     10.43 sec, wall time      9.50 sec
E1 = -470.2462761684666  E_coul = 181.82230623972163
cycle= 4 E= -157.35590587849  delta_E= -0.000169  |g|= 0.00411  |ddm|= 0.021
    CPU time for cycle= 4     12.66 sec, wall time      9.84 sec
  HOMO = -0.456542414516584  LUMO = 0.142644771648249
  mo_energy =
[-11.2116073  -11.2109917  -11.2055815  -11.20557601  -1.07081086
  -0.98201726  -0.86293933  -0.78973512  -0.63944362  -0.58554287
  -0.57502931  -0.56891877  -0.51566331  -0.49631442  -0.46864487
  -0.46248609  -0.45654241   0.14264477   0.15994855   0.17947666
   0.18149891   0.21373603   0.22497959   0.2304703    0.24708497
   0.25068265   0.26457673   0.31275174   0.31812066   0.36091431
   0.3821079    0.40503236   0.41044878   0.43171571   0.45339713
   0.46432695   0.51501851   0.5552809    0.56194311   0.57256372
   0.57778217   0.62324912   0.64071024   0.64352139   0.64905723
   0.65139651   0.66471485   0.68192399   0.68602133   0.69272634
   0.70873209   0.71499404   0.75631171   0.8121021    0.82468029
   0.88331431   0.91637029   0.9275388    0.93990714   0.95270628
   0.96910844   1.02057743   1.05579586   1.07867018   1.08953135
   1.11947781   1.17874065   1.18539815   1.19497991   1.23578271
   1.24663207   1.27330791   1.27539972   1.30231855   1.3071556
   1.314088     1.33046329   1.37521484   1.38511995   1.3897553
   1.39302897   1.40701111   1.40877746   1.41854245   1.47881226
   1.49110005   1.49859596   1.52003085   1.55326553   1.5561561
   1.57577458   1.59735503   1.60682851   1.63082307   1.64548516
   1.65161686   1.70033116   1.75136601   1.75816032   1.79499079
   1.8111946    1.8321361    1.8386665    1.90196913   1.93282624
   1.9466645    2.48604666   2.57430331   2.57474736   2.59488078
   2.61396223   2.64295061   2.68578024   2.70444874   2.75836058
   2.76478521   2.80287406   2.80970144   2.8590139    2.86496301
   2.90327237   2.90441883   2.90541224   2.97985027   3.00443984
   3.01819664   3.05180724   3.09238354   3.10338648   3.13648386
   3.1411565    3.14636276   3.16612372   3.1893517    3.21983925
   3.23478987   3.28647726   3.28807456   3.31948377   3.33349907
   3.36616133   3.36959518   3.39986579   3.40360533   3.41540307
   3.42196541   3.42717923   3.45279558   3.45608567   3.49251163
   3.5181247    3.53590365   3.54383662   3.57432334   3.59525202
   3.59742109   3.62775079   3.66173186   3.66833022   3.70620857
   3.75997898   3.7632589    3.78309675   3.78690584   3.81022121
   3.86361772   3.86900278   3.88753692   3.90580925   3.926685
   3.95187948   3.98227001   3.98398442   4.01570553   4.07689409
   4.08494716   4.08505907   4.12413731   4.14252336   4.15961189
   4.17191825   4.17861974   4.18659141   4.21233107   4.23498738
   4.24663551   4.28667244   4.30404485   4.3094508    4.31272522
   4.35835239   4.37719335   4.39771788   4.43524827   4.44307155
   4.45478804   4.46933348   4.4721417    4.49216476   4.50434492
   4.55224645   4.57951392   4.58638584   4.62440198   4.6379878
   4.64186918   4.66945621   4.67652328   4.69078062   4.74968771
   4.7699314    4.77112827   4.84724641   4.91442742   4.98909535
   5.02601252   5.02784016   5.05867975   5.09170033   5.20223193
   5.22171707   5.22350427   5.22906538   5.24120429   5.25060621
   5.31154085   5.31277985   5.35803253   5.36500156   5.37610074
   5.44844127   5.47871669   5.50019314   5.59414021   5.63806385
   5.6622694    5.72287754   5.73170913   5.7495939    5.77139449
   5.77755942   5.79334142   5.85218951   5.88381151   5.900578
   5.90425082   5.90739282   5.94324989   6.0028574    6.05167651
   6.28863267   6.31885535   6.33663428   6.33816236   6.35645807
   6.43344779  13.2151423   13.59443492  14.17561247  14.31651061]
    CPU time for vj and vk     10.60 sec, wall time      9.03 sec
E1 = -470.2310507862746  E_coul = 181.80707383894728
cycle= 5 E= -157.355912897072  delta_E= -7.02e-06  |g|= 0.00083  |ddm|= 0.00499
    CPU time for cycle= 5     12.82 sec, wall time      9.37 sec
  HOMO = -0.456668182819428  LUMO = 0.142637571776243
  mo_energy =
[-11.2118623  -11.21124583 -11.20517011 -11.20516511  -1.07091245
  -0.98196864  -0.86291284  -0.78977716  -0.63949225  -0.58553288
  -0.5750154   -0.56887608  -0.51564341  -0.49629821  -0.4687473
  -0.46256085  -0.45666818   0.14263757   0.15997241   0.17947333
   0.18148992   0.21376113   0.22499683   0.2304689    0.2471142
   0.25069041   0.26458529   0.31276733   0.31808903   0.3609153
   0.38210969   0.40503033   0.41046934   0.43168488   0.45334746
   0.46425635   0.51500335   0.55529092   0.56195239   0.57253137
   0.57773651   0.62325336   0.64069247   0.64352346   0.64910928
   0.65145091   0.66472548   0.68191426   0.68605782   0.69268829
   0.7086789    0.71491961   0.75630829   0.81210383   0.82469164
   0.88324549   0.91634256   0.92754039   0.93985951   0.95266076
   0.9691249    1.02057193   1.05580214   1.07860766   1.0895631
   1.11947527   1.17873566   1.18537949   1.19500001   1.23580494
   1.24660484   1.27329476   1.27538228   1.30231618   1.3070885
   1.31412255   1.33046714   1.37518026   1.38512203   1.38973621
   1.39301918   1.407006     1.40875118   1.41849638   1.47876209
   1.49110297   1.49857345   1.5200037    1.55328874   1.55616704
   1.57579244   1.59735247   1.60680549   1.63081926   1.64550045
   1.65157732   1.70034857   1.7513781    1.75814382   1.79499021
   1.8111382    1.83222974   1.83867637   1.90195051   1.93278025
   1.94665272   2.48605871   2.57437529   2.57478291   2.59486341
   2.61392266   2.64287541   2.68576469   2.7043962    2.75836773
   2.76478104   2.80283867   2.80963834   2.85899087   2.86486279
   2.90321729   2.90433519   2.90542272   2.97987245   3.00442994
   3.01813922   3.05176905   3.09246149   3.10335765   3.13654788
   3.1412262    3.14640203   3.16611479   3.18937087   3.2198818
   3.23480568   3.28649233   3.28815464   3.31950893   3.33346935
   3.36614838   3.36960741   3.39976158   3.40371517   3.41545683
   3.42199967   3.42720403   3.45276155   3.45606867   3.49241095
   3.51815952   3.5359315    3.54376042   3.57429975   3.59519201
   3.59737112   3.62781375   3.66181139   3.66839601   3.70618558
   3.76001808   3.76334851   3.78313829   3.78694502   3.8102292
   3.86361179   3.86897415   3.88752545   3.9058141    3.92669729
   3.9519107    3.98222424   3.98398262   4.01571996   4.07689961
   4.08493608   4.08507737   4.1241352    4.14254787   4.15963906
   4.17196137   4.17861721   4.18654444   4.21231728   4.23502445
   4.24663346   4.28666564   4.30403184   4.30945146   4.31278843
   4.35836841   4.37721103   4.39774796   4.4352782    4.44307063
   4.45482787   4.46940873   4.47215397   4.49215975   4.50434168
   4.55226628   4.57952808   4.58643418   4.62445276   4.63797794
   4.64185772   4.66950229   4.67652462   4.69081619   4.7496913
   4.76991023   4.77115228   4.84727595   4.91442573   4.98908785
   5.02600325   5.02785519   5.05862577   5.09162003   5.20227439
   5.22177594   5.22353582   5.22909571   5.24119607   5.25059552
   5.31157784   5.31284381   5.35798788   5.36499235   5.37611295
   5.44846623   5.47868805   5.50021208   5.59422494   5.6381679
   5.66225051   5.7230127    5.73173974   5.74963628   5.77151721
   5.7776775    5.79345686   5.85214437   5.88380942   5.90052256
   5.90425509   5.90739496   5.94314303   6.00284267   6.05156567
   6.28874501   6.31903426   6.33680872   6.338278     6.35637874
   6.43334066  13.21499074  13.59426952  14.17582597  14.31675251]
    CPU time for vj and vk     10.55 sec, wall time      8.93 sec
E1 = -470.2306686253616  E_coul = 181.8066913358859
cycle= 6 E= -157.355913239221  delta_E= -3.42e-07  |g|= 0.000248  |ddm|= 0.00146
    CPU time for cycle= 6     12.85 sec, wall time      9.24 sec
  HOMO = -0.45669643054953  LUMO = 0.142632649368405
  mo_energy =
[-11.21180976 -11.21119339 -11.20536451 -11.20535934  -1.07093366
  -0.98202492  -0.86295318  -0.78979027  -0.63949434  -0.58556532
  -0.57506638  -0.56890777  -0.51568655  -0.49632399  -0.46878587
  -0.46256242  -0.45669643   0.14263265   0.15996116   0.17947232
   0.18149109   0.21375228   0.22498979   0.23046981   0.24710656
   0.25068662   0.26458122   0.31275876   0.31808236   0.36090688
   0.38209987   0.40501642   0.41045632   0.43167377   0.45333163
   0.46425632   0.51498317   0.55527785   0.56194277   0.57252282
   0.5777336    0.623237     0.6406757    0.64350811   0.64907827
   0.65142038   0.6647085    0.68190423   0.68603466   0.69267815
   0.70865872   0.71491567   0.75629373   0.81209129   0.82467226
   0.88323815   0.91633309   0.92752414   0.93985852   0.95264588
   0.96910633   1.02055954   1.05578051   1.07858985   1.08954579
   1.11946596   1.17872071   1.18536489   1.19497927   1.23578464
   1.24659032   1.27328164   1.27537315   1.30230131   1.30708286
   1.31408993   1.33045052   1.37516757   1.38511038   1.38973632
   1.39300921   1.40699455   1.40874215   1.41848511   1.47875793
   1.49108575   1.49855143   1.51999045   1.55326556   1.5561529
   1.57577658   1.59733644   1.60679514   1.63080847   1.64548317
   1.65156765   1.70033299   1.75136425   1.75812932   1.79497235
   1.81113996   1.83219581   1.83866007   1.90193423   1.93276974
   1.94664277   2.48603807   2.57434197   2.57474638   2.59484554
   2.61392054   2.64285465   2.6857246    2.70437522   2.75834117
   2.76475862   2.80282001   2.80963037   2.85895591   2.8648579
   2.90319795   2.90432567   2.90538401   2.97982926   3.00440155
   3.01811902   3.05174852   3.09241027   3.10332558   3.13650443
   3.1411714    3.14635457   3.16608515   3.189338     3.2198472
   3.2347731    3.28644877   3.28809789   3.31946533   3.33343918
   3.36612257   3.36957626   3.39975946   3.40365278   3.41541028
   3.42195716   3.42717046   3.45275197   3.45604348   3.49241061
   3.51812277   3.53590856   3.54376501   3.57428722   3.5951922
   3.59736472   3.62777414   3.66179509   3.66837962   3.70616397
   3.75999235   3.76331968   3.78310954   3.78692088   3.81020911
   3.86358731   3.86897624   3.88751934   3.9057935    3.92668484
   3.95188494   3.98221393   3.9839674    4.01570824   4.0768977
   4.08491865   4.08506615   4.12413241   4.14253357   4.15962405
   4.17194954   4.17860859   4.18654104   4.21232042   4.23501225
   4.24662655   4.28665834   4.30402745   4.30943926   4.3127756
   4.35836957   4.37720668   4.39773373   4.43527182   4.44306681
   4.45481996   4.46940118   4.47214194   4.49215285   4.50433013
   4.5522557    4.57953143   4.58641334   4.62442882   4.63797281
   4.64186034   4.6694876    4.67652756   4.69080142   4.74967048
   4.76991159   4.77113157   4.8472656    4.91441035   4.98908213
   5.0259916    5.02784591   5.05861235   5.09161342   5.20225012
   5.2217441    5.22351437   5.22907477   5.24118067   5.25058062
   5.31155747   5.31281924   5.35798428   5.36498583   5.37609268
   5.44842989   5.47866759   5.50018917   5.5941884    5.63812739
   5.66222316   5.72297459   5.73171882   5.74961003   5.77148064
   5.77764379   5.79341812   5.85214718   5.8837892    5.90052716
   5.90422639   5.90737526   5.94315299   6.00282125   6.05157476
   6.28869508   6.31897478   6.33675005   6.338226     6.35638664
   6.43335767  13.21501467  13.59429108  14.17571555  14.3166326 ]
    CPU time for vj and vk      9.72 sec, wall time      8.34 sec
E1 = -470.2309432364462  E_coul = 181.80696592175917
cycle= 7 E= -157.355913264432  delta_E= -2.52e-08  |g|= 5.88e-05  |ddm|= 0.00038
    CPU time for cycle= 7     12.10 sec, wall time      8.65 sec
  HOMO = -0.456701110845863  LUMO = 0.142632244126967
  mo_energy =
[-11.21183322 -11.21121682 -11.20534074 -11.20533561  -1.07093837
  -0.9820246   -0.86295549  -0.78979683  -0.63949297  -0.5855645
  -0.57506598  -0.56890212  -0.51568442  -0.49631959  -0.46878777
  -0.46256344  -0.45670111   0.14263224   0.15996007   0.17947177
   0.18149243   0.21375097   0.22498999   0.23047175   0.24710649
   0.25068778   0.26458211   0.31275738   0.3180822    0.36090591
   0.38209875   0.40501723   0.41045641   0.43167139   0.4533312
   0.46425724   0.51498186   0.55527777   0.56194354   0.57252236
   0.57773478   0.62323491   0.64067539   0.64351068   0.64907812
   0.65142455   0.66471123   0.68190659   0.68603305   0.69267564
   0.70865665   0.71491166   0.75629425   0.81209159   0.82467246
   0.8832371    0.91633438   0.92752394   0.93985787   0.95264614
   0.96910656   1.02056034   1.05577911   1.07859039   1.08954578
   1.1194661    1.1787213    1.18536354   1.19498131   1.23578471
   1.24659094   1.27328129   1.27537294   1.30230171   1.30708217
   1.31408956   1.33044921   1.37516682   1.38510962   1.3897363
   1.39300958   1.40699412   1.40874129   1.41848263   1.47875819
   1.4910849    1.4985528    1.51998994   1.5532689    1.55615256
   1.57577722   1.59733744   1.6067956    1.63080812   1.64548372
   1.65156607   1.70033275   1.75136359   1.75813026   1.79497198
   1.81113769   1.83219788   1.83866023   1.90193275   1.93276756
   1.9466403    2.48604051   2.57434274   2.57474709   2.59484623
   2.61391868   2.64285283   2.68572587   2.70437365   2.75834183
   2.76475913   2.8028196    2.80962937   2.85895798   2.86485501
   2.90319466   2.90432243   2.90538678   2.97983109   3.00440232
   3.01811694   3.05174699   3.09241422   3.10332751   3.13650658
   3.14117639   3.14635732   3.16608677   3.18933822   3.21984929
   3.23477155   3.28645209   3.28810215   3.31946781   3.33344031
   3.36612401   3.36957654   3.39975609   3.40365844   3.41541437
   3.42195973   3.42717068   3.45274976   3.45604432   3.49240469
   3.51812339   3.53590969   3.54376129   3.57428629   3.59518988
   3.59735984   3.62777748   3.6617957    3.6683808    3.70616262
   3.75999684   3.76332018   3.78311062   3.78692077   3.81021172
   3.86358883   3.86897502   3.88751973   3.90579543   3.92668453
   3.95188666   3.98221412   3.98396791   4.01570728   4.07689847
   4.08491916   4.08506918   4.12413296   4.14253442   4.15962435
   4.17194938   4.17860659   4.18653828   4.21232122   4.23501395
   4.24662662   4.28665812   4.30402682   4.30944053   4.31277486
   4.35837142   4.37720669   4.39773313   4.43527285   4.44306574
   4.45482096   4.46940216   4.47214334   4.49215238   4.50432881
   4.55225603   4.57953152   4.58641474   4.6244289    4.63797286
   4.64186057   4.6694891    4.6765281    4.69080238   4.74967234
   4.7699103    4.77113162   4.84726644   4.9144106    4.9890823
   5.02599217   5.02784417   5.05860995   5.09161192   5.20225189
   5.22174789   5.22351493   5.22907753   5.24117949   5.25058216
   5.3115575    5.31281994   5.35798314   5.36498633   5.3760934
   5.4484332    5.47866727   5.50019075   5.59419069   5.63813121
   5.66222425   5.72297907   5.73172149   5.74961218   5.7714847
   5.77764726   5.79342277   5.85214423   5.8837909    5.9005239
   5.90422825   5.90737692   5.94314848   6.0028212    6.05156844
   6.28870239   6.31898102   6.3367564    6.33823389   6.35638135
   6.43335086  13.21500187  13.5942785   14.17572781  14.31664658]
    CPU time for vj and vk      9.64 sec, wall time      8.00 sec
E1 = -470.2308696722321  E_coul = 181.80689235563386
cycle= 8 E= -157.355913266343  delta_E= -1.91e-09  |g|= 7.51e-06  |ddm|= 0.000141
    CPU time for cycle= 8     11.69 sec, wall time      8.33 sec
  HOMO = -0.456701486325302  LUMO = 0.142631889332545
  mo_energy =
[-11.21183275 -11.21121635 -11.2053438  -11.20533867  -1.07093933
  -0.98202576  -0.86295683  -0.78979752  -0.6394931   -0.58556506
  -0.57506662  -0.56890306  -0.51568526  -0.49632052  -0.46878825
  -0.46256355  -0.45670149   0.14263189   0.15995959   0.17947152
   0.18149214   0.21375076   0.22498957   0.23047155   0.2471063
   0.25068752   0.26458194   0.31275707   0.3180815    0.36090544
   0.38209826   0.4050169    0.41045615   0.43167127   0.45333064
   0.46425693   0.51498126   0.55527714   0.56194328   0.57252196
   0.57773455   0.6232346    0.64067468   0.64351028   0.6490772
   0.65142358   0.66471071   0.68190618   0.68603255   0.69267504
   0.70865595   0.71491139   0.75629371   0.81209121   0.82467187
   0.88323668   0.91633352   0.92752337   0.93985756   0.95264553
   0.96910622   1.02055967   1.0557787    1.07858944   1.08954525
   1.11946557   1.17872078   1.18536293   1.19498068   1.23578405
   1.24659035   1.27328072   1.27537274   1.30230106   1.30708168
   1.31408877   1.33044852   1.37516619   1.38510891   1.38973607
   1.39300896   1.40699389   1.40874084   1.41848227   1.47875789
   1.49108437   1.49855201   1.51998929   1.55326814   1.55615226
   1.57577681   1.5973367    1.60679502   1.6308078    1.64548309
   1.65156546   1.70033237   1.7513629    1.75812977   1.79497138
   1.81113742   1.83219685   1.83865945   1.90193185   1.93276729
   1.94663991   2.48603937   2.57434226   2.57474654   2.59484533
   2.61391808   2.64285204   2.68572505   2.70437285   2.75834084
   2.76475828   2.80281882   2.80962875   2.85895681   2.86485431
   2.90319393   2.90432195   2.90538579   2.97983009   3.00440143
   3.01811629   3.05174611   3.09241322   3.10332635   3.13650571
   3.14117517   3.14635649   3.16608579   3.18933704   3.21984823
   3.23477122   3.28645094   3.28810101   3.31946686   3.3334391
   3.36612296   3.36957575   3.3997556    3.40365703   3.41541322
   3.42195859   3.42716992   3.45274918   3.45604341   3.49240435
   3.5181223    3.53590905   3.54376071   3.57428556   3.59518949
   3.59735958   3.62777642   3.66179488   3.66837978   3.70616199
   3.75999547   3.76331998   3.78310991   3.78692045   3.81021055
   3.86358783   3.86897468   3.88751912   3.90579451   3.92668409
   3.95188575   3.98221334   3.98396732   4.01570696   4.07689812
   4.08491824   4.0850683    4.12413234   4.14253369   4.15962369
   4.1719489    4.17860625   4.18653765   4.21232076   4.23501324
   4.24662579   4.28665762   4.3040261    4.30943954   4.31277493
   4.35837062   4.37720632   4.39773257   4.43527208   4.44306527
   4.45482024   4.4694017    4.47214239   4.49215178   4.50432824
   4.55225544   4.57953132   4.58641398   4.62442815   4.63797207
   4.64186023   4.66948835   4.67652777   4.69080181   4.74967144
   4.76990986   4.77113105   4.84726603   4.9144098    4.9890818
   5.02599159   5.02784378   5.05860948   5.09161122   5.20225094
   5.22174685   5.22351416   5.2290766    5.24117868   5.25058113
   5.31155709   5.31281954   5.35798257   5.36498552   5.37609268
   5.4484322    5.47866652   5.50018987   5.59418991   5.63813043
   5.66222337   5.72297815   5.73172043   5.74961145   5.77148383
   5.77764644   5.79342167   5.85214394   5.88379004   5.90052371
   5.90422727   5.90737606   5.94314815   6.00282036   6.05156804
   6.28870073   6.31898015   6.33675547   6.3382322    6.35638112
   6.43335064  13.21500201  13.59427836  14.17572587  14.31664452]
    CPU time for vj and vk      8.89 sec, wall time      7.68 sec
E1 = -470.2308797693905  E_coul = 181.8069024527623
cycle= 9 E= -157.355913266373  delta_E= -3e-11  |g|= 1.48e-06  |ddm|= 1.82e-05
    CPU time for cycle= 9     12.04 sec, wall time      8.14 sec
  HOMO = -0.456701514209103  LUMO = 0.142631908129021
  mo_energy =
[-11.21183296 -11.21121656 -11.20534347 -11.20533834  -1.07093935
  -0.98202576  -0.86295675  -0.78979752  -0.63949306  -0.58556508
  -0.57506669  -0.56890298  -0.51568522  -0.49632043  -0.46878822
  -0.46256353  -0.45670151   0.14263191   0.1599596    0.17947152
   0.18149216   0.21375073   0.2249896    0.23047159   0.24710628
   0.25068754   0.26458194   0.31275708   0.31808158   0.36090547
   0.38209831   0.40501689   0.41045615   0.43167124   0.45333069
   0.46425698   0.51498128   0.5552772    0.56194329   0.57252196
   0.57773458   0.62323457   0.64067471   0.64351029   0.64907729
   0.65142368   0.66471074   0.68190622   0.68603253   0.69267506
   0.70865596   0.71491136   0.75629374   0.81209119   0.82467191
   0.8832367    0.91633361   0.9275234    0.93985758   0.95264556
   0.9691062    1.02055972   1.05577864   1.0785895    1.08954525
   1.1194656    1.1787208    1.18536294   1.19498071   1.23578409
   1.24659037   1.27328075   1.27537273   1.30230111   1.3070817
   1.31408881   1.33044858   1.37516621   1.38510897   1.3897361
   1.39300901   1.40699387   1.40874085   1.41848224   1.47875789
   1.49108438   1.49855203   1.51998932   1.55326819   1.55615226
   1.57577681   1.59733676   1.60679505   1.6308078    1.64548313
   1.6515655    1.7003324    1.75136297   1.7581298    1.79497141
   1.81113743   1.83219696   1.83865954   1.90193192   1.93276725
   1.94663992   2.48603948   2.57434224   2.57474648   2.59484539
   2.61391813   2.64285201   2.68572502   2.70437287   2.75834092
   2.76475833   2.80281884   2.80962876   2.85895684   2.86485431
   2.90319391   2.90432191   2.90538581   2.97983011   3.00440148
   3.01811627   3.05174617   3.09241328   3.10332641   3.13650578
   3.14117524   3.14635648   3.16608586   3.1893372    3.21984837
   3.23477113   3.28645097   3.28810107   3.31946689   3.33343918
   3.36612303   3.36957581   3.39975557   3.40365714   3.41541327
   3.42195865   3.42716996   3.45274923   3.45604344   3.4924043
   3.51812239   3.5359091    3.54376076   3.57428561   3.59518951
   3.59735952   3.6277765    3.66179497   3.6683799    3.70616197
   3.7599956    3.76331991   3.78310991   3.78692036   3.81021064
   3.86358786   3.86897469   3.88751918   3.90579455   3.92668406
   3.95188582   3.98221336   3.98396735   4.01570697   4.07689815
   4.08491828   4.08506836   4.12413239   4.14253373   4.15962372
   4.1719489    4.17860622   4.18653769   4.21232082   4.23501325
   4.24662585   4.28665764   4.30402617   4.30943962   4.31277485
   4.35837073   4.37720635   4.39773256   4.43527214   4.4430653
   4.45482027   4.46940169   4.47214247   4.49215184   4.50432828
   4.55225548   4.57953134   4.58641404   4.6244282    4.63797211
   4.64186029   4.66948843   4.67652782   4.69080182   4.74967148
   4.76990987   4.77113105   4.84726608   4.91440985   4.98908185
   5.02599162   5.0278438    5.05860943   5.09161125   5.202251
   5.2217469    5.22351419   5.22907665   5.24117876   5.25058122
   5.31155707   5.31281949   5.35798261   5.36498561   5.37609272
   5.44843221   5.47866653   5.50018992   5.59418993   5.63813044
   5.66222338   5.72297827   5.73172055   5.74961147   5.77148392
   5.77764653   5.79342179   5.85214396   5.88379009   5.90052371
   5.90422729   5.90737612   5.94314815   6.00282038   6.05156801
   6.28870096   6.31898022   6.33675556   6.33823242   6.3563811
   6.43335064  13.21500189  13.59427828  14.17572604  14.31664471]
    CPU time for vj and vk      8.38 sec, wall time      6.96 sec
E1 = -470.2308804906267  E_coul = 181.80690317399834
Extra cycle  E= -157.355913266373  delta_E= -1.14e-13  |g|= 5.31e-07  |ddm|= 2.54e-06
    CPU time for scf_cycle    138.33 sec, wall time    101.41 sec
    CPU time for SCF    138.35 sec, wall time    101.42 sec
converged SCF energy = -157.355913266373
