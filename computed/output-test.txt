#INFO: **** input file is /Users/allen/Desktop/Coding/Github/PySCF-UI/stream.py ****
import streamlit as st
from pyscf import gto, scf
from streamlit.runtime.scriptrunner import add_script_run_ctx
import threading
import time

if 'queue' not in st.session_state:
    st.session_state['queue'] = []
if 'results' not in st.session_state:
    st.session_state['results'] = []


def compute_pyscf(atom, basis_option, verbose_option):
    print(atom)
    print(basis_option)
    print(verbose_option)
    mol = gto.Mole()
    mol.atom = atom
    mol.basis = basis_option
    mol.verbose = int(verbose_option[0])
    mol.output = 'computed/output-test.txt'
    mol.build()

    mf = scf.RHF(mol)
    mf.kernel()
    outputFile = open("computed/output-test.txt", "r")
    # Extract energy and time information
    time = None
    energy = None
    for line in outputFile.readlines():
        if line.startswith("    CPU time for SCF"):
            time = float(line.split(" ")[-2])

        elif line.startswith("converged SCF energy = "):
            energy = float(line.split(" ")[-1])
    return energy, time


def getMoleculeName(atom):
    d = {}
    for line in atom.split("\n"):
        try:
            name = line.split()[0]
            if name in d:
                d[name] += 1
            else:
                d[name] = 1
        except:
            pass
    name = ""
    for key in d:
        name += key + str(d[key])
    return name


# Streamlit layout
st.title("PySCF")

xyz_input = st.text_area("XYZ Input")
basis_option = st.selectbox("Basis", ["cc-pVTZ", "asdf"])
verbose_option = st.selectbox("Verbose", [
                              "3, energy only", "4, cycles and energy", "5, cycles energy and runtime", "9, max"])

col1, col2, col3 = st.columns(3, gap="small")


def addToQueue(atom):
    st.session_state['queue'].append(atom)


if col1.button("Add to Queue"):
    if xyz_input:
        addToQueue(xyz_input)
    else:
        st.warning("Please provide an XYZ input.")


if col2.button("Compute"):
    if len(st.session_state['queue']) > 0:
        st.write("Computing...")
        for atom in st.session_state['queue']:
            energy, time_val = compute_pyscf(
                atom, basis_option, verbose_option)
            molecule_name = getMoleculeName(atom)
            st.session_state['results'].append(
                (molecule_name, energy, time_val))
            # st.write(
            #     f"Result: {molecule_name} | Energy: {energy} | Time: {time_val} seconds")
    else:
        st.warning("Please add an XYZ input to the queue.")

if st.session_state['results']:
    st.subheader("Results")
    for result_item in st.session_state['results']:
        st.write(
            f"{result_item[0]} | Energy: {result_item[1]} | Time: {result_item[2]} seconds")

if col3.button('View Log'):
    with open('computed/output-test.txt', 'r') as file:
        log_data = file.read()
        st.markdown(f'```\n{log_data}\n```')


# Attempt at creating an async queue, need to find a way to detect browser closing to stop the queue

# def runQueue():
#     for i in range(1, 10):
#         time.sleep(1)
#         print("test", str(i))


# if 'queue-running' not in st.session_state:
#     st.session_state['queue-running'] = True
#     t = threading.Thread(target=runQueue)
#     add_script_run_ctx(t)
#     t.start()
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Allens-MacBook-Pro.local', release='22.5.0', version='Darwin Kernel Version 22.5.0: Thu Jun  8 22:22:23 PDT 2023; root:xnu-8796.121.3~7/RELEASE_ARM64_T6020', machine='arm64')  Threads 1
Python 3.11.5 (main, Aug 24 2023, 15:09:45) [Clang 14.0.3 (clang-1403.0.22.14.1)]
numpy 1.25.2  scipy 1.11.2
Date: Sat Oct 28 15:39:11 2023
PySCF version 2.4.0
PySCF path  /opt/homebrew/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 11
[INPUT] num. electrons = 26
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C1     0.000000000000   0.586300000000   0.000000000000 AA    0.000000000000   1.107946426832   0.000000000000 Bohr   0.0
[INPUT]  2 C2    -1.268100000000  -0.262600000000   0.000000000000 AA   -2.396361698561  -0.496242080311   0.000000000000 Bohr   0.0
[INPUT]  3 C3     1.268100000000  -0.262600000000   0.000000000000 AA    2.396361698561  -0.496242080311   0.000000000000 Bohr   0.0
[INPUT]  4 H4     0.000000000000   1.244900000000   0.876000000000 AA    0.000000000000   2.352520052471   1.655400085119 Bohr   0.0
[INPUT]  5 H5    -0.000300000000   1.245300000000  -0.875800000000 AA   -0.000566917837   2.353275942921  -1.655022139894 Bohr   0.0
[INPUT]  6 H6    -2.157600000000   0.374200000000   0.000000000000 AA   -4.077273086362   0.707135515812   0.000000000000 Bohr   0.0
[INPUT]  7 H7     2.157600000000   0.374300000000   0.000000000000 AA    4.077273086362   0.707324488425   0.000000000000 Bohr   0.0
[INPUT]  8 H8    -1.327100000000  -0.901400000000   0.880000000000 AA   -2.507855539910  -1.703399128683   1.662958989617 Bohr   0.0
[INPUT]  9 H9    -1.327100000000  -0.901400000000  -0.880000000000 AA   -2.507855539910  -1.703399128683  -1.662958989617 Bohr   0.0
[INPUT] 10 H10    1.327100000000  -0.901400000000  -0.880000000000 AA    2.507855539910  -1.703399128683  -1.662958989617 Bohr   0.0
[INPUT] 11 H11    1.327200000000  -0.901400000000   0.880000000000 AA    2.508044512523  -1.703399128683   1.662958989617 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C1
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1
[INPUT] H6
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H8
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H11
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H9
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H7
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H10
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H5
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] C2
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1
[INPUT] C3
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1
[INPUT] H4
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1

nuclear repulsion = 82.617818667249
number of shells = 75
number of NR pGTOs = 254
number of NR cGTOs = 202
basis = cc-pVTZ
ecp = {}
CPU time:       239.01


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/ps/y7p6rrk51xd7xy3_qgbkdmk00000gn/T/tmp9s072rjf
max_memory 4000 MB (current use 0 MB)
Set gradient conv threshold to 3.16228e-05
Initial guess from minao.
E1 = -319.44081481078325  E_coul = 118.28363564702367
init E= -118.539360496511
cond(S) = 8919.26976399037
    CPU time for initialize scf     13.21 sec, wall time      4.88 sec
  HOMO = -0.358518617767333  LUMO = 0.0945213676182646
  mo_energy =
[-11.3210036  -11.31955324 -11.31358871  -1.50466271  -1.187668
  -0.9216785   -0.59617844  -0.55305893  -0.48132089  -0.45199114
  -0.37646047  -0.36821322  -0.35851862   0.09452137   0.13774763
   0.14745185   0.15992055   0.18027006   0.20757397   0.21304106
   0.22698302   0.25048138   0.31419731   0.35531261   0.35824195
   0.37382699   0.39521475   0.40213801   0.46155308   0.48665017
   0.5346523    0.53757118   0.54538298   0.55282644   0.57068396
   0.5746462    0.58179596   0.60860062   0.60943488   0.61709282
   0.692882     0.72929958   0.77205876   0.85535929   0.85573066
   0.87702513   0.92516463   0.94246822   1.02018484   1.04889854
   1.09620041   1.11228202   1.13531013   1.15702625   1.18192857
   1.20037526   1.2307198    1.25084175   1.26520435   1.28585626
   1.28860518   1.33789225   1.33798631   1.35027292   1.3662333
   1.40867425   1.41348584   1.44179065   1.47125188   1.48125767
   1.51404687   1.54320719   1.57022987   1.57080685   1.60423721
   1.65381934   1.68477135   1.7072143    1.74267731   1.75631605
   1.81338708   1.83760731   2.40892368   2.46501296   2.48861601
   2.53053488   2.55393153   2.59726472   2.66372863   2.68736641
   2.71015598   2.7414873    2.74189353   2.78072184   2.86384722
   2.86651363   2.8934439    2.94307961   3.00976814   3.03190562
   3.05136398   3.05513951   3.06050737   3.07743857   3.13525767
   3.1555378    3.15590046   3.24807394   3.26298674   3.29379073
   3.29386106   3.29487073   3.31507744   3.32608282   3.35652964
   3.39235551   3.397906     3.41674942   3.43888437   3.50706597
   3.53080323   3.58059852   3.60691786   3.62255149   3.62760937
   3.67812438   3.6785873    3.73087123   3.7397542    3.79317953
   3.79422448   3.84287869   3.84524535   3.87856252   3.97345638
   3.98828674   4.00053129   4.05027685   4.05043781   4.06267519
   4.07591424   4.09064549   4.11296686   4.13707389   4.19377368
   4.20147648   4.20828357   4.23930515   4.27958359   4.28214121
   4.3105686    4.37318833   4.38926983   4.39002062   4.41949393
   4.42792238   4.46547935   4.53031824   4.54666041   4.55529214
   4.58943098   4.58955923   4.59916849   4.65722635   4.71175401
   4.80238469   4.80415642   4.84068408   5.01752608   5.06101937
   5.0806205    5.10506445   5.12857466   5.14244748   5.15069577
   5.19563824   5.21900339   5.27572389   5.32558062   5.41204929
   5.43172873   5.51094284   5.57647517   5.6024758    5.6380155
   5.64508612   5.64846254   5.66552131   5.67650684   5.7506363
   5.77318207   5.79448372   5.8065212    5.88784295   6.19368948
   6.20413251   6.20968534   6.23774886   6.26469064  12.98512931
  13.92242392  14.05075138]
E1 = -321.1669733147382  E_coul = 120.27011310600139
cycle= 1 E= -118.279041541488  delta_E= 0.26  |g|= 0.28  |ddm|= 1.79
    CPU time for cycle= 1      3.84 sec, wall time      0.99 sec
  HOMO = -0.476690319982263  LUMO = 0.135126897660937
  mo_energy =
[-11.25531506 -11.22457855 -11.22453343  -1.07382968  -0.94363736
  -0.81852077  -0.63641122  -0.60628307  -0.56046641  -0.54047361
  -0.48497148  -0.47856931  -0.47669032   0.1351269    0.17274713
   0.17886591   0.186224     0.21407134   0.22827913   0.23846551
   0.25750651   0.28884473   0.35919913   0.37480322   0.37630027
   0.39793694   0.43590977   0.43601238   0.48049093   0.51439197
   0.57441895   0.57987753   0.60879024   0.61478544   0.63753002
   0.64805622   0.65876077   0.66872903   0.67344166   0.68452395
   0.72566116   0.76202245   0.81344213   0.8883562    0.88888842
   0.90841993   0.95528906   0.97064267   1.06292001   1.07587336
   1.12288336   1.14640843   1.17053236   1.19236932   1.21652967
   1.23805093   1.26901056   1.28559271   1.29877239   1.3179798
   1.33818835   1.36287261   1.37744896   1.3961471    1.39775125
   1.43745022   1.45605565   1.478164     1.50618523   1.52590364
   1.5451253    1.57519607   1.60293351   1.61192048   1.63636151
   1.69444008   1.73376364   1.74535869   1.78824791   1.81689891
   1.85353583   1.88907215   2.46659984   2.51700666   2.54513057
   2.59288176   2.61689444   2.65807276   2.72386656   2.747407
   2.76587716   2.79460966   2.81142182   2.84477834   2.92898092
   2.93340181   2.9638663    3.00835216   3.07202978   3.09670436
   3.12067697   3.12201176   3.12626569   3.14224502   3.20121146
   3.2222612    3.22299504   3.31567181   3.32883064   3.35894752
   3.36017112   3.36125167   3.3850298    3.39359302   3.41874388
   3.45035867   3.46498642   3.47739775   3.50198614   3.56117674
   3.59005922   3.63170242   3.66033554   3.68089457   3.68581884
   3.72989301   3.73238412   3.78376553   3.79286347   3.83864923
   3.84924687   3.89465915   3.89556602   3.9306296    4.03140795
   4.03925495   4.05224039   4.10048093   4.11444438   4.11760257
   4.12692037   4.13876895   4.1653036    4.19951288   4.24551698
   4.25468042   4.25493573   4.28845805   4.32573565   4.33033858
   4.35855363   4.41148798   4.43934226   4.44223702   4.45678931
   4.4774024    4.520201     4.57153306   4.6002502    4.60578337
   4.63137891   4.64427199   4.66105265   4.71082189   4.76335052
   4.86031726   4.8672687    4.89234049   5.07556159   5.11456812
   5.14417318   5.15764703   5.18565577   5.19722684   5.21292411
   5.24982675   5.2741759    5.33708715   5.38720567   5.47525137
   5.50102924   5.57486261   5.64108168   5.66720224   5.70419783
   5.70843096   5.71251509   5.73003192   5.73900661   5.81232108
   5.83651732   5.86627661   5.86794592   5.96189516   6.27359668
   6.28444469   6.28921717   6.3178575    6.33552411  13.03776075
  13.99300297  14.12197266]
E1 = -321.7087293608843  E_coul = 120.7854094270291
cycle= 2 E= -118.305501266606  delta_E= -0.0265  |g|= 0.0741  |ddm|= 0.201
    CPU time for cycle= 2      5.88 sec, wall time      1.26 sec
  HOMO = -0.461976190079797  LUMO = 0.141532507047514
  mo_energy =
[-11.19465202 -11.19460768 -11.19122711  -1.04458857  -0.92064981
  -0.7943029   -0.61739026  -0.5889868   -0.54501973  -0.52799018
  -0.46922278  -0.46307649  -0.46197619   0.14153251   0.17841578
   0.18522823   0.19214339   0.22124565   0.23410525   0.24352585
   0.26341849   0.29908494   0.37076916   0.38190407   0.38292763
   0.40713815   0.44614617   0.44831671   0.48889549   0.52225367
   0.58727756   0.59283715   0.62354445   0.62945144   0.65030185
   0.66147862   0.68176794   0.68541713   0.68939125   0.70367345
   0.73829715   0.77590393   0.82403674   0.89780816   0.89956137
   0.9191891    0.96608849   0.98149232   1.07574418   1.08503165
   1.13192893   1.15830006   1.18236465   1.20298767   1.22901145
   1.24968338   1.28180269   1.30009708   1.31075083   1.32851664
   1.35395442   1.3725671    1.3916178    1.40730607   1.41413305
   1.44804742   1.47020043   1.4908559    1.51763788   1.53952429
   1.55651228   1.5855504    1.61563664   1.62549212   1.64526774
   1.70717045   1.75153313   1.75746688   1.80266905   1.83307973
   1.8680952    1.90810136   2.48401565   2.53715085   2.56533807
   2.61231879   2.64160379   2.67962801   2.74447014   2.76488266
   2.7867374    2.81653319   2.83752774   2.86971316   2.95070534
   2.95749184   2.99075196   3.03278225   3.09349453   3.12012874
   3.14031814   3.14094644   3.14629324   3.16513795   3.22268356
   3.24447418   3.24451674   3.33713468   3.34864721   3.3797844
   3.38223133   3.38298601   3.40613944   3.41392362   3.44202279
   3.47343242   3.48527901   3.50510754   3.52926856   3.58279776
   3.61227123   3.64835297   3.67848834   3.70060285   3.70760654
   3.74675099   3.75066507   3.80099301   3.81002598   3.85873407
   3.86907369   3.91234495   3.91319929   3.94941526   4.05360108
   4.05756217   4.07325776   4.11830565   4.1386979    4.13930542
   4.14710225   4.1570186    4.18343244   4.22682088   4.26593527
   4.27240222   4.27381419   4.30715248   4.34435838   4.34968594
   4.37696284   4.42620968   4.45786519   4.46318064   4.47149645
   4.49519895   4.54046493   4.58816059   4.61927794   4.62673631
   4.64884784   4.66178625   4.68483849   4.73137851   4.78424807
   4.88099326   4.89169565   4.91325689   5.0977751    5.13383623
   5.16572432   5.17583207   5.2053467    5.22096728   5.2357214
   5.26956096   5.29779865   5.35937095   5.40925455   5.49456341
   5.52376401   5.59615044   5.66294811   5.68992194   5.72653407
   5.72799594   5.73232288   5.75177357   5.75913868   5.83884649
   5.85936748   5.89118787   5.89245165   5.99337844   6.29718315
   6.30795706   6.31301726   6.34165795   6.36946636  13.07937618
  14.01893774  14.14608527]
E1 = -321.48976257674855  E_coul = 120.56448272891022
cycle= 3 E= -118.307461180589  delta_E= -0.00196  |g|= 0.0224  |ddm|= 0.0685
    CPU time for cycle= 3      8.74 sec, wall time      1.56 sec
  HOMO = -0.468278628758025  LUMO = 0.140389915839962
  mo_energy =
[-11.21885483 -11.2082914  -11.20825726  -1.05310876  -0.92581038
  -0.80021132  -0.623677    -0.59510312  -0.55111629  -0.53223854
  -0.47689422  -0.47169588  -0.46827863   0.14038992   0.17776007
   0.18414811   0.19089309   0.22018777   0.23272054   0.2428191
   0.26256259   0.29698917   0.36836334   0.38023414   0.3811841
   0.40407332   0.44355924   0.44486107   0.48687534   0.5209125
   0.58342992   0.58879161   0.61942725   0.62593705   0.64710795
   0.65954745   0.67615544   0.68056528   0.68498951   0.69766196
   0.73529034   0.77259135   0.82158706   0.89536463   0.89613492
   0.91666212   0.96374117   0.97921479   1.0713025    1.08371723
   1.13086329   1.1550053    1.17908226   1.20021452   1.22579459
   1.24647992   1.27834687   1.29482011   1.30774435   1.32618271
   1.34887601   1.37090884   1.3871518    1.40466431   1.40858036
   1.44560302   1.46608496   1.48699855   1.51418753   1.53550486
   1.55393675   1.58249015   1.61205322   1.62198694   1.64279041
   1.70377122   1.7471798    1.75434893   1.79926026   1.8301855
   1.86385674   1.90296597   2.48087088   2.53275764   2.56019701
   2.60795354   2.63215639   2.67324306   2.73885271   2.76127379
   2.78174081   2.80982096   2.82758921   2.86067684   2.94359159
   2.94933789   2.98140892   3.02447152   3.08709021   3.11279416
   3.13523267   3.13589099   3.14102772   3.15723862   3.21594778
   3.23739621   3.23959219   3.33115379   3.34293613   3.37365223
   3.37574623   3.37650014   3.40000247   3.40840902   3.43471754
   3.46720956   3.48019105   3.4961324    3.52173473   3.57722905
   3.60651309   3.64701512   3.6760003    3.69625339   3.70204233
   3.74406139   3.74706722   3.7978554    3.80697418   3.85473303
   3.86409071   3.90906276   3.9101701    3.94524398   4.04879586
   4.0545525    4.06952484   4.11601535   4.13170045   4.13510749
   4.14405012   4.1550358    4.18061965   4.21906587   4.26255587
   4.27065462   4.27112855   4.30404021   4.34184125   4.34536971
   4.37505283   4.42576425   4.4544099    4.45862241   4.47122055
   4.49279832   4.53627341   4.5868969    4.61563316   4.62191022
   4.6470486    4.6595215    4.67924187   4.72773829   4.78035958
   4.87631357   4.886759     4.90837527   5.0916888    5.1301725
   5.15994222   5.17284277   5.2014975    5.21563397   5.22975419
   5.26610713   5.29260388   5.35397932   5.40425634   5.49004896
   5.51860544   5.59063706   5.65799422   5.68523745   5.72181562
   5.72501434   5.72942553   5.74730112   5.75612425   5.83252143
   5.85393601   5.88475489   5.88625368   5.98398218   6.29289641
   6.3035329    6.30833489   6.337092     6.36014994  13.06314921
  14.00906239  14.13706682]
E1 = -321.6030918362253  E_coul = 120.67767210425392
cycle= 4 E= -118.307601064722  delta_E= -0.00014  |g|= 0.0035  |ddm|= 0.0168
    CPU time for cycle= 4      6.45 sec, wall time      1.22 sec
  HOMO = -0.468063807645915  LUMO = 0.140538797889452
  mo_energy =
[-11.21745354 -11.2080504  -11.20801493  -1.0522804   -0.92543096
  -0.79986705  -0.62321708  -0.59486291  -0.55095732  -0.53209183
  -0.47669572  -0.47154399  -0.46806381   0.1405388    0.17776987
   0.18431002   0.19112944   0.22029298   0.23293308   0.24290058
   0.26270545   0.29718207   0.36845381   0.38029424   0.38121672
   0.40408718   0.4437626    0.44509185   0.48701606   0.52089725
   0.58372175   0.58920876   0.61970134   0.62607877   0.64734966
   0.65949001   0.67669217   0.68074894   0.68533514   0.69785913
   0.73546281   0.77278134   0.82172763   0.89550621   0.89640818
   0.91692748   0.9638131    0.97937796   1.0716465    1.08381138
   1.13091956   1.15528791   1.17922631   1.20035446   1.22584463
   1.24657524   1.27852753   1.29523054   1.30789366   1.32627007
   1.3490383    1.37103476   1.38740539   1.40484205   1.40882588
   1.44577545   1.46623507   1.48734375   1.5144532    1.53580103
   1.55405713   1.58274958   1.61233397   1.62219573   1.64296972
   1.70390647   1.74736677   1.75453124   1.79942245   1.83014735
   1.86403285   1.90313707   2.48109491   2.53300187   2.56047487
   2.60803827   2.63278299   2.67368656   2.73915838   2.76135531
   2.78215323   2.81032576   2.82827402   2.8611951    2.9439567
   2.94973329   2.98193824   3.02487584   3.08743003   3.11309121
   3.13531113   3.13607104   3.14121649   3.15780174   3.21617651
   3.23760582   3.23961869   3.33140049   3.34324565   3.37402937
   3.37607284   3.37666768   3.40009145   3.40854046   3.43518824
   3.46747263   3.48030574   3.49663249   3.52206448   3.57754937
   3.60684398   3.64696915   3.67601098   3.69632265   3.70246617
   3.74434254   3.74724349   3.79813156   3.80717271   3.85505937
   3.86453191   3.9093476    3.91029109   3.94553264   4.04922238
   4.05466315   4.06989089   4.11625329   4.13216471   4.13540181
   4.14443176   4.15505835   4.18093258   4.21944661   4.26278589
   4.2709103    4.2712219    4.30426065   4.34202131   4.34561127
   4.37526919   4.42591557   4.45464069   4.4588099    4.47135096
   4.49296586   4.53645644   4.58706224   4.61592398   4.62230962
   4.64726482   4.65961458   4.6793645    4.72805162   4.78062835
   4.87665303   4.88688087   4.9087528    5.09219087   5.13038725
   5.16021379   5.17308228   5.20175621   5.21595776   5.22996794
   5.26640539   5.29294161   5.35420137   5.40457027   5.49033148
   5.51892583   5.59100382   5.65822649   5.68551081   5.72196503
   5.72500615   5.72942373   5.74758428   5.75612167   5.83284719
   5.85429252   5.8851291    5.88669412   5.98452493   6.29287405
   6.30362503   6.30845965   6.33712671   6.3606075   13.06398564
  14.00936826  14.13728369]
E1 = -321.5922609191221  E_coul = 120.66683600214195
cycle= 5 E= -118.307606249731  delta_E= -5.19e-06  |g|= 0.000652  |ddm|= 0.00407
    CPU time for cycle= 5      6.25 sec, wall time      1.23 sec
  HOMO = -0.468100467622209  LUMO = 0.140532318203755
  mo_energy =
[-11.21757737 -11.20796949 -11.20793445  -1.05235763  -0.92544057
  -0.7998686   -0.62324488  -0.59488423  -0.55100536  -0.53212696
  -0.47677682  -0.47164053  -0.46810047   0.14053232   0.17778556
   0.18431297   0.1911224    0.2203144    0.23293631   0.24290942
   0.26269421   0.29716419   0.36846045   0.3802915    0.38119522
   0.40407833   0.44373404   0.44505406   0.48700624   0.52088558
   0.58370727   0.58917414   0.61966868   0.62605531   0.64733048
   0.65950822   0.67661245   0.6807548    0.68531915   0.69784224
   0.73546406   0.77279048   0.82169416   0.89546988   0.89636167
   0.91687862   0.96382611   0.97935968   1.07158108   1.08379295
   1.13090502   1.15526101   1.179195     1.2003387    1.22585091
   1.24655328   1.27852683   1.29517253   1.30789247   1.32627226
   1.34900443   1.37104105   1.38737505   1.40483617   1.40879713
   1.44574369   1.46622163   1.48731389   1.51441448   1.53576903
   1.55407913   1.5827068    1.61231889   1.62218738   1.64292258
   1.70389499   1.74739401   1.75451567   1.79941447   1.8301848
   1.86402076   1.90314684   2.48105704   2.5329875    2.56048009
   2.60806521   2.63269658   2.67363164   2.73911572   2.76134487
   2.78212538   2.81026764   2.82818947   2.86114213   2.94392588
   2.94970495   2.98187975   3.0248579    3.08738507   3.11307823
   3.13531481   3.13602439   3.14118528   3.15773075   3.21616435
   3.23758736   3.23962283   3.33136068   3.34322018   3.37398749
   3.37604539   3.37666898   3.40008666   3.4085241    3.43514578
   3.46747972   3.4803256    3.49657702   3.52204221   3.57752915
   3.60681644   3.64700314   3.67603569   3.69637029   3.70243293
   3.74430201   3.74725971   3.79810597   3.80717277   3.85505978
   3.86448085   3.90933047   3.91031731   3.94551627   4.04921707
   4.05470589   4.06989293   4.11625079   4.13214112   4.1354049
   4.14442549   4.15511793   4.1809074    4.21944933   4.26282687
   4.27088073   4.27128479   4.30425402   4.34206283   4.34560868
   4.37528368   4.42593503   4.45465167   4.45884528   4.47137993
   4.4929764    4.53647359   4.58709941   4.61591129   4.62230429
   4.64728769   4.65967181   4.67939028   4.72805089   4.78065841
   4.87663562   4.8869118    4.90875461   5.092138     5.13040242
   5.16019269   5.17307421   5.20174707   5.21597969   5.22997069
   5.26639352   5.29295363   5.35422351   5.40456134   5.49030063
   5.51893473   5.59095288   5.65823355   5.68550705   5.72200324
   5.72504893   5.72946112   5.74756681   5.75617271   5.8328592
   5.85427722   5.88510346   5.8866643    5.98450071   6.29293536
   6.30362725   6.30845852   6.33717808   6.36059229  13.06392342
  14.00938785  14.13731661]
E1 = -321.5923622027558  E_coul = 120.66693703708728
cycle= 6 E= -118.307606498419  delta_E= -2.49e-07  |g|= 0.00015  |ddm|= 0.00118
    CPU time for cycle= 6      6.30 sec, wall time      1.23 sec
  HOMO = -0.468106106249186  LUMO = 0.140527926235282
  mo_energy =
[-11.21756816 -11.20804195 -11.20800669  -1.05237936  -0.92546864
  -0.79989088  -0.62324731  -0.5949069   -0.55102448  -0.53213241
  -0.47679608  -0.47167461  -0.46810611   0.14052793   0.17777777
   0.18431192   0.19112519   0.22030787   0.23293874   0.24290777
   0.26269656   0.29716294   0.36845584   0.38028213   0.38119093
   0.40406021   0.44373058   0.44504539   0.48700272   0.52088071
   0.58369822   0.58917363   0.61966005   0.62604284   0.64732484
   0.65949203   0.67660521   0.68074336   0.6853166    0.69782406
   0.7354582    0.77278251   0.82168706   0.89546378   0.89635287
   0.9168794    0.9638133    0.97935662   1.07157182   1.08378882
   1.13090113   1.15525471   1.1791881    1.20032995   1.22583824
   1.24654284   1.27851477   1.29516891   1.30788525   1.32626623
   1.34899309   1.37103897   1.38736689   1.40482887   1.40878431
   1.44574306   1.46620989   1.48731002   1.51440807   1.53576042
   1.55406757   1.58269895   1.61231537   1.62217976   1.64291741
   1.70388583   1.74738353   1.75450826   1.79940888   1.83017051
   1.86400882   1.90313659   2.48105596   2.53298348   2.56046059
   2.60804482   2.63267723   2.67361975   2.73910537   2.76133382
   2.78212119   2.81025967   2.82817498   2.86112392   2.94390716
   2.94968528   2.9818653    3.02483684   3.08737171   3.11305774
   3.13529463   3.13600796   3.14117039   3.15771197   3.21614078
   3.2375685    3.23961236   3.33134816   3.34319979   3.37396916
   3.37602761   3.37664613   3.400065     3.40850773   3.4351313
   3.46746611   3.48030462   3.49656714   3.52203541   3.5775257
   3.60680705   3.64699885   3.67602868   3.69634731   3.70242543
   3.74430479   3.7472438    3.79810298   3.80716013   3.85505855
   3.86447475   3.90932507   3.91030677   3.94550963   4.0492092
   4.05469387   4.06989329   4.11624978   4.13213041   4.13540588
   4.14442885   4.15510933   4.18090941   4.21943936   4.26281533
   4.27088456   4.27127779   4.3042548    4.34205834   4.34559936
   4.37528652   4.42593999   4.45464346   4.45883379   4.47138351
   4.49297575   4.53646534   4.58710104   4.61590831   4.62230011
   4.64728909   4.65966185   4.67937618   4.72805058   4.78065123
   4.87662905   4.88690376   4.90874944   5.09212871   5.13039382
   5.16017976   5.17307094   5.20174002   5.21597067   5.22995933
   5.26639202   5.29294928   5.35420441   5.40455245   5.49028562
   5.51891854   5.59094235   5.65822029   5.68550255   5.72198527
   5.72503777   5.7294525    5.74756485   5.75616163   5.83285051
   5.85426953   5.88509527   5.88665831   5.98448739   6.29291285
   6.30361907   6.30845073   6.33715584   6.36058581  13.06392008
  14.0093477   14.13727369]
E1 = -321.59240184338796  E_coul = 120.66697666383776
cycle= 7 E= -118.307606512301  delta_E= -1.39e-08  |g|= 3.07e-05  |ddm|= 0.000345
    CPU time for cycle= 7      6.31 sec, wall time      1.24 sec
  HOMO = -0.468105673807398  LUMO = 0.140527380669668
  mo_energy =
[-11.21758918 -11.20802506 -11.20798991  -1.05238046  -0.92546738
  -0.79989312  -0.62324587  -0.594904    -0.55102258  -0.53212985
  -0.47679583  -0.47167291  -0.46810567   0.14052738   0.17777738
   0.18431143   0.19112531   0.22030853   0.23293963   0.24290794
   0.26269613   0.2971621    0.36845523   0.38028306   0.38118991
   0.4040607    0.44373108   0.44504582   0.48700315   0.52087981
   0.58369915   0.58917425   0.61966065   0.62604205   0.64732658
   0.65949263   0.67660439   0.680743     0.68531808   0.69782435
   0.73545897   0.77278364   0.82168709   0.89546324   0.89635302
   0.91687853   0.96381457   0.97935629   1.0715726    1.08378839
   1.13090064   1.15525539   1.17918759   1.2003315    1.22583842
   1.24654311   1.27851572   1.29516854   1.30788529   1.32626647
   1.34899215   1.3710391    1.38736684   1.40482922   1.40878361
   1.4457415    1.46620985   1.48731086   1.51440829   1.53576178
   1.55406886   1.58269923   1.61231522   1.62218055   1.64291728
   1.70388638   1.74738349   1.75450915   1.79940882   1.83017209
   1.86400871   1.90313572   2.48105605   2.53298248   2.56046255
   2.60804716   2.63267778   2.67362012   2.73910552   2.76133511
   2.78212084   2.81025817   2.82817551   2.86112411   2.94390976
   2.94968656   2.98186511   3.02483873   3.08737261   3.11305927
   3.13529824   3.13601055   3.14117239   3.15771348   3.21614312
   3.23756939   3.23961315   3.33134956   3.34320339   3.37397177
   3.37602938   3.37664876   3.40006724   3.4085097    3.43513255
   3.46746623   3.48030881   3.49656352   3.52203285   3.57752483
   3.60680639   3.64699907   3.67602874   3.69635      3.70242578
   3.74430441   3.74724604   3.7981039    3.80716216   3.85505764
   3.86447479   3.9093258    3.91030804   3.94551017   4.04921018
   4.05469577   4.06989351   4.11625013   4.13213156   4.13540494
   4.14442885   4.15511018   4.18090953   4.21943789   4.26281693
   4.27088343   4.27127962   4.30425358   4.34205918   4.34559856
   4.3752863    4.42593966   4.45464414   4.4588344    4.47138337
   4.49297581   4.53646542   4.5871014    4.61590866   4.62230049
   4.64728896   4.65966314   4.67937794   4.72805057   4.78065246
   4.87662959   4.88690364   4.90874993   5.09212868   5.13039518
   5.16018044   5.17307198   5.20174112   5.21597111   5.2299592
   5.26639231   5.29294922   5.35420646   5.40455357   5.49028788
   5.51892192   5.59094291   5.65822221   5.68550333   5.72198834
   5.7250403    5.72945471   5.74756529   5.75616411   5.83284976
   5.8542702    5.8850961    5.88665793   5.98448608   6.29291814
   6.30362177   6.30845315   6.33716105   6.36058155  13.06391054
  14.00935562  14.13728313]
E1 = -321.5923606303419  E_coul = 120.66693545033988
cycle= 8 E= -118.307606512753  delta_E= -4.52e-10  |g|= 6.74e-06  |ddm|= 6.45e-05
    CPU time for cycle= 8      6.54 sec, wall time      1.25 sec
  HOMO = -0.468106005258167  LUMO = 0.140526956467098
  mo_energy =
[-11.21758605 -11.20803159 -11.20799641  -1.05238187  -0.92546964
  -0.79989396  -0.62324654  -0.59490541  -0.55102427  -0.53213206
  -0.47679667  -0.47167439  -0.46810601   0.14052696   0.17777696
   0.18431121   0.19112497   0.22030821   0.23293952   0.24290744
   0.26269542   0.29716143   0.36845469   0.38028262   0.38118945
   0.40406056   0.44373061   0.44504519   0.48700267   0.52087893
   0.58369856   0.58917393   0.61965947   0.62604102   0.64732524
   0.65949131   0.67660303   0.6807429    0.68531721   0.69782343
   0.73545831   0.77278295   0.82168612   0.8954625    0.89635251
   0.91687779   0.96381393   0.97935569   1.07157121   1.08378759
   1.13089977   1.15525483   1.17918652   1.2003303    1.2258377
   1.246542     1.27851517   1.29516787   1.30788499   1.3262658
   1.34899114   1.37103894   1.38736602   1.40482877   1.408783
   1.44574085   1.46620891   1.48731007   1.51440716   1.53576036
   1.55406849   1.58269812   1.61231495   1.62217969   1.64291594
   1.70388524   1.74738339   1.75450818   1.79940774   1.8301704
   1.86400818   1.90313535   2.48105422   2.53298197   2.56046154
   2.60804589   2.63267622   2.67361883   2.73910408   2.76133333
   2.78212035   2.8102578    2.8281736    2.861123     2.94390786
   2.94968491   2.98186351   3.02483744   3.0873711    3.11305785
   3.13529593   3.13600825   3.14117045   3.15771201   3.21614148
   3.23756781   3.23961157   3.33134755   3.3432012    3.37396987
   3.37602793   3.37664688   3.40006522   3.40850768   3.435131
   3.46746583   3.48030639   3.4965635    3.52203296   3.57752404
   3.60680542   3.64699783   3.67602754   3.69634911   3.7024247
   3.74430267   3.74724467   3.79810219   3.8071606    3.85505762
   3.86447346   3.90932452   3.91030702   3.94550923   4.04920932
   4.05469516   4.06989309   4.11624903   4.13213017   4.13540395
   4.14442819   4.15510947   4.18090819   4.21943746   4.26281664
   4.27088203   4.27127883   4.30425261   4.34205905   4.34559806
   4.37528547   4.42593857   4.45464328   4.45883418   4.47138239
   4.49297484   4.53646446   4.58710092   4.61590737   4.62230016
   4.64728847   4.6596624    4.67937612   4.72804968   4.7806519
   4.87662859   4.8869027    4.90874921   5.09212799   5.13039383
   5.16017919   5.17307025   5.2017394    5.21597095   5.22995831
   5.26639091   5.29294907   5.35420521   5.40455204   5.490286
   5.51891999   5.59094141   5.6582207    5.68550202   5.72198685
   5.72503862   5.72945297   5.74756361   5.75616256   5.83285005
   5.85426915   5.88509423   5.88665723   5.98448568   6.2929159
   6.30361913   6.30845064   6.33715877   6.36058259  13.06391178
  14.00935187  14.13727898]
E1 = -321.5923817562617  E_coul = 120.66695657624479
Extra cycle  E= -118.307606512768  delta_E= -1.49e-11  |g|= 2.66e-06  |ddm|= 8.93e-06
    CPU time for scf_cycle     69.35 sec, wall time     16.12 sec
    CPU time for SCF     69.35 sec, wall time     16.12 sec
converged SCF energy = -118.307606512768
