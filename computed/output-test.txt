#INFO: **** input file is /Users/allen/Desktop/Coding/Github/PySCF-UI/main.py ****
from time import sleep
import time
import Tkinter as tk
import ScrolledText as st
import pyscf
import threading
from pyscf import gto, scf

queue = []

def pyscfThread():
    while (runThread):
        print(str(len(queue)) + " molecules in queue")
        if (len(queue) > 0):
            mol = gto.Mole()
            mol.atom = queue[0]
            print(mol.atom)
            sleep(3)
            mol.basis = 'cc-pVTZ'
            mol.verbose = 5
            # mol.output = 'computed/output_' + (str(time.time())) + '.txt'
            mol.output = 'computed/output-test.txt'
            mol.build()

            mf = scf.RHF(mol)
            mf.kernel()
            print("Completed computation")
            queue.pop(0)
            updateQueueText()
        sleep(1)
    
def getOutputThread():
    while (runThread):
        updateOutputText()
        sleep(0.2)

def addToQueue():
    queue.append(xyzInput.get("1.0", tk.END))
    updateQueueText()

def endThread():
    global runThread
    runThread = False
    root.destroy()

root = tk.Tk()
root.title("PySCF")
root.protocol("WM_DELETE_WINDOW", endThread)

w, h = root.winfo_screenwidth(), root.winfo_screenheight()
root.geometry("%dx%d" % (w, h))

root.columnconfigure(0, weight=1)
root.columnconfigure(1, weight=3)
root.rowconfigure(0, weight=1)
root.rowconfigure(1, weight=4)

# Frames

xyzInputFrame = tk.Frame(root, background='red', borderwidth=1, relief="solid")
settingsFrame = tk.Frame(root, background='blue', borderwidth=1, relief="solid")
queueFrame = tk.Frame(root, background='green', borderwidth=1, relief="solid")
outputFrame = tk.Frame(root, background='black', borderwidth=1, relief="solid")
xyzInputFrame.pack_propagate(0)
settingsFrame.grid_propagate(0)
queueFrame.pack_propagate(0)
outputFrame.pack_propagate(0)

# XYZ Input
xyzInputFrame.rowconfigure(0, weight=3)
xyzInputFrame.rowconfigure(1, weight=1)

xyzInput = st.ScrolledText(xyzInputFrame)
xyzButton = tk.Button(xyzInputFrame, text="Compute", command=addToQueue)

xyzButton.pack(padx=4, pady=4, side="bottom", fill="both")
xyzInput.pack(padx=4, pady=4, side="top", fill="x")


xyzInputFrame.grid(column=0, row=0, sticky="nesw")
settingsFrame.grid(column=1, row=0, sticky="nesw")
queueFrame.grid(column=0, row=1, sticky="nesw")
outputFrame.grid(column=1, row=1, sticky="nesw")

queueText = tk.Text(queueFrame)

def updateQueueText():
    queueText.configure(state=tk.NORMAL)
    queueText.delete('1.0', tk.END)
    for queueItem in queue:
        queueText.insert(tk.END, queueItem.split('\n')[0])
        queueText.insert(tk.END, "\n---------------\n")
    queueText.configure(state=tk.DISABLED)

queueText.pack(expand=True,fill=tk.BOTH)
updateQueueText()

outputText = tk.Text(outputFrame)

currentText = ""
def updateOutputText():
    global currentText
    outputFile = open("computed/output-test.txt", "r")
    newText = outputFile.read()
    if (newText == currentText):
        return
    currentText = newText
    outputText.configure(state=tk.NORMAL)
    outputText.delete('1.0', tk.END)
    outputText.insert(tk.END, newText)
    outputText.see("end")
    outputText.configure(state=tk.DISABLED)

outputText.pack(expand=True,fill=tk.BOTH)
updateOutputText()


runThread = True
pythread = threading.Thread(target=pyscfThread)
pythread.start()
outputThread = threading.Thread(target=getOutputThread)
outputThread.start()

root.mainloop()



# mol = gto.Mole()
# mol.atom = """
# C	-0.4218040	0.6407370	0.0000000
# C	0.4218040	-0.6407370	0.0000000
# C	0.4218040	1.9198930	0.0000000
# C	-0.4218040	-1.9198930	0.0000000
# H	-1.0831630	0.6373520	0.8782670
# H	-1.0831630	0.6373520	-0.8782670
# H	1.0831630	-0.6373520	0.8782670
# H	1.0831630	-0.6373520	-0.8782670
# H	-0.2088070	2.8163860	0.0000000
# H	1.0686920	1.9672850	0.8847760
# H	1.0686920	1.9672850	-0.8847760
# H	0.2088070	-2.8163860	0.0000000
# H	-1.0686920	-1.9672850	0.8847760
# H	-1.0686920	-1.9672850	-0.8847760
# """
# mol.basis = 'cc-pVTZ'
# mol.verbose = 5
# mol.output = 'output.txt'
# mol.build()

# mf = scf.RHF(mol)
# mf.kernel()
#INFO: ******************** input file end ********************


System: ('Darwin', 'Allens-MacBook-Pro.local', '22.5.0', 'Darwin Kernel Version 22.5.0: Thu Jun  8 22:22:23 PDT 2023; root:xnu-8796.121.3~7/RELEASE_ARM64_T6020', 'x86_64', 'i386')  Threads 1
Python 2.7.18 (v2.7.18:8d21aa21f2, Apr 19 2020, 20:48:48) 
[GCC 4.2.1 Compatible Apple LLVM 6.0 (clang-600.0.57)]
numpy 1.16.6  scipy 1.2.3
Date: Wed Oct  4 17:46:07 2023
PySCF version 1.7.6
PySCF path  /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 11
[INPUT] num. electrons = 26
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 C1     0.000000000000   0.586300000000   0.000000000000 AA    0.000000000000   1.107946426832   0.000000000000 Bohr
[INPUT]  2 C2    -1.268100000000  -0.262600000000   0.000000000000 AA   -2.396361698561  -0.496242080311   0.000000000000 Bohr
[INPUT]  3 C3     1.268100000000  -0.262600000000   0.000000000000 AA    2.396361698561  -0.496242080311   0.000000000000 Bohr
[INPUT]  4 H4     0.000000000000   1.244900000000   0.876000000000 AA    0.000000000000   2.352520052471   1.655400085119 Bohr
[INPUT]  5 H5    -0.000300000000   1.245300000000  -0.875800000000 AA   -0.000566917837   2.353275942921  -1.655022139894 Bohr
[INPUT]  6 H6    -2.157600000000   0.374200000000   0.000000000000 AA   -4.077273086362   0.707135515812   0.000000000000 Bohr
[INPUT]  7 H7     2.157600000000   0.374300000000   0.000000000000 AA    4.077273086362   0.707324488425   0.000000000000 Bohr
[INPUT]  8 H8    -1.327100000000  -0.901400000000   0.880000000000 AA   -2.507855539910  -1.703399128683   1.662958989617 Bohr
[INPUT]  9 H9    -1.327100000000  -0.901400000000  -0.880000000000 AA   -2.507855539910  -1.703399128683  -1.662958989617 Bohr
[INPUT] 10 H10    1.327100000000  -0.901400000000  -0.880000000000 AA    2.507855539910  -1.703399128683  -1.662958989617 Bohr
[INPUT] 11 H11    1.327200000000  -0.901400000000   0.880000000000 AA    2.508044512523  -1.703399128683   1.662958989617 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H8
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H9
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H10
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H11
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H6
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H7
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H4
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] H5
[INPUT] 0    0    [3    /1   ]  33.87             0.006068
                                5.095             0.045308
                                1.159             0.202822
[INPUT] 0    0    [1    /1   ]  0.3258               1
[INPUT] 0    0    [1    /1   ]  0.1027               1
[INPUT] 1    0    [1    /1   ]  1.407                1
[INPUT] 1    0    [1    /1   ]  0.388                1
[INPUT] 2    0    [1    /1   ]  1.057                1
[INPUT] C3
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1
[INPUT] C2
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1
[INPUT] C1
[INPUT] 0    0    [8    /2   ]  8236              0.000531 -0.000113
                                1235              0.004108 -0.000878
                                280.8             0.021087 -0.00454
                                79.27             0.081853 -0.018133
                                25.59             0.234817 -0.05576
                                8.997             0.434401 -0.126895
                                3.319             0.346129 -0.170352
                                0.3643            -0.008983 0.598684
[INPUT] 0    0    [1    /1   ]  0.9059               1
[INPUT] 0    0    [1    /1   ]  0.1285               1
[INPUT] 1    0    [3    /1   ]  18.71             0.014031
                                4.133             0.086866
                                1.2               0.290216
[INPUT] 1    0    [1    /1   ]  0.3827               1
[INPUT] 1    0    [1    /1   ]  0.1209               1
[INPUT] 2    0    [1    /1   ]  1.097                1
[INPUT] 2    0    [1    /1   ]  0.318                1
[INPUT] 3    0    [1    /1   ]  0.761                1

nuclear repulsion = 82.617818667249
number of shells = 75
number of NR pGTOs = 254
number of NR cGTOs = 202
basis = cc-pVTZ
ecp = {}
CPU time:         5.46


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /var/folders/ps/y7p6rrk51xd7xy3_qgbkdmk00000gn/T/tmpOdgBeN
max_memory 4000 MB (current use 0 MB)
Set gradient conv threshold to 3.16228e-05
E1 = -319.4408148107829  E_coul = 118.28363564702376
init E= -118.53936049651
cond(S) = 8919.269763974642
    CPU time for initialize scf      5.22 sec, wall time      5.21 sec
  HOMO = -0.358518617767333  LUMO = 0.0945213676185362
  mo_energy =
[-11.3210036  -11.31955324 -11.31358871  -1.50466271  -1.187668
  -0.9216785   -0.59617844  -0.55305893  -0.48132089  -0.45199114
  -0.37646047  -0.36821322  -0.35851862   0.09452137   0.13774763
   0.14745185   0.15992055   0.18027006   0.20757397   0.21304106
   0.22698302   0.25048138   0.31419731   0.35531261   0.35824195
   0.37382699   0.39521475   0.40213801   0.46155308   0.48665017
   0.5346523    0.53757118   0.54538298   0.55282644   0.57068396
   0.5746462    0.58179596   0.60860062   0.60943488   0.61709282
   0.692882     0.72929958   0.77205876   0.85535929   0.85573066
   0.87702513   0.92516463   0.94246822   1.02018484   1.04889854
   1.09620041   1.11228202   1.13531013   1.15702625   1.18192857
   1.20037526   1.2307198    1.25084175   1.26520435   1.28585626
   1.28860518   1.33789225   1.33798631   1.35027292   1.3662333
   1.40867425   1.41348584   1.44179065   1.47125188   1.48125767
   1.51404687   1.54320719   1.57022987   1.57080685   1.60423721
   1.65381934   1.68477135   1.7072143    1.74267731   1.75631605
   1.81338708   1.83760731   2.40892368   2.46501296   2.48861601
   2.53053488   2.55393153   2.59726472   2.66372863   2.68736641
   2.71015598   2.7414873    2.74189353   2.78072184   2.86384722
   2.86651363   2.8934439    2.94307961   3.00976814   3.03190562
   3.05136398   3.05513951   3.06050737   3.07743857   3.13525767
   3.1555378    3.15590046   3.24807394   3.26298674   3.29379073
   3.29386106   3.29487073   3.31507744   3.32608282   3.35652964
   3.39235551   3.397906     3.41674942   3.43888437   3.50706597
   3.53080323   3.58059852   3.60691786   3.62255149   3.62760937
   3.67812438   3.6785873    3.73087123   3.7397542    3.79317953
   3.79422448   3.84287869   3.84524535   3.87856252   3.97345638
   3.98828674   4.00053129   4.05027685   4.05043781   4.06267519
   4.07591424   4.09064549   4.11296686   4.13707389   4.19377368
   4.20147648   4.20828357   4.23930515   4.27958359   4.28214121
   4.3105686    4.37318833   4.38926983   4.39002062   4.41949393
   4.42792238   4.46547935   4.53031824   4.54666041   4.55529214
   4.58943098   4.58955923   4.59916849   4.65722635   4.71175401
   4.80238469   4.80415642   4.84068408   5.01752608   5.06101937
   5.0806205    5.10506445   5.12857466   5.14244748   5.15069577
   5.19563824   5.21900339   5.27572389   5.32558062   5.41204929
   5.43172873   5.51094284   5.57647517   5.6024758    5.6380155
   5.64508612   5.64846254   5.66552131   5.67650684   5.7506363
   5.77318207   5.79448372   5.8065212    5.88784295   6.19368948
   6.20413251   6.20968534   6.23774886   6.26469064  12.98512931
  13.92242392  14.05075138]
E1 = -321.16697331473773  E_coul = 120.27011310600102
cycle= 1 E= -118.279041541488  delta_E= 0.26  |g|= 0.28  |ddm|= 1.79
    CPU time for cycle= 1      0.82 sec, wall time      0.80 sec
  HOMO = -0.476690319982261  LUMO = 0.135126897661132
  mo_energy =
[-11.25531506 -11.22457855 -11.22453343  -1.07382968  -0.94363736
  -0.81852077  -0.63641122  -0.60628307  -0.56046641  -0.54047361
  -0.48497148  -0.47856931  -0.47669032   0.1351269    0.17274713
   0.17886591   0.186224     0.21407134   0.22827913   0.23846551
   0.25750651   0.28884473   0.35919913   0.37480322   0.37630027
   0.39793694   0.43590977   0.43601238   0.48049093   0.51439197
   0.57441895   0.57987753   0.60879024   0.61478544   0.63753002
   0.64805622   0.65876077   0.66872903   0.67344166   0.68452395
   0.72566116   0.76202245   0.81344213   0.8883562    0.88888842
   0.90841993   0.95528906   0.97064267   1.06292001   1.07587336
   1.12288336   1.14640843   1.17053236   1.19236932   1.21652967
   1.23805093   1.26901056   1.28559271   1.29877239   1.3179798
   1.33818835   1.36287261   1.37744896   1.3961471    1.39775125
   1.43745022   1.45605565   1.478164     1.50618523   1.52590364
   1.5451253    1.57519607   1.60293351   1.61192048   1.63636151
   1.69444008   1.73376364   1.74535869   1.78824791   1.81689891
   1.85353583   1.88907215   2.46659984   2.51700666   2.54513057
   2.59288176   2.61689444   2.65807276   2.72386656   2.747407
   2.76587716   2.79460966   2.81142182   2.84477834   2.92898092
   2.93340181   2.9638663    3.00835216   3.07202978   3.09670436
   3.12067697   3.12201176   3.12626569   3.14224502   3.20121146
   3.2222612    3.22299504   3.31567181   3.32883064   3.35894752
   3.36017112   3.36125167   3.3850298    3.39359302   3.41874388
   3.45035867   3.46498642   3.47739775   3.50198614   3.56117674
   3.59005922   3.63170242   3.66033554   3.68089457   3.68581884
   3.72989301   3.73238412   3.78376553   3.79286347   3.83864923
   3.84924687   3.89465915   3.89556602   3.9306296    4.03140795
   4.03925495   4.05224039   4.10048093   4.11444438   4.11760257
   4.12692037   4.13876895   4.1653036    4.19951288   4.24551698
   4.25468042   4.25493573   4.28845805   4.32573565   4.33033858
   4.35855363   4.41148798   4.43934226   4.44223702   4.45678931
   4.4774024    4.520201     4.57153306   4.6002502    4.60578337
   4.63137891   4.64427199   4.66105265   4.71082189   4.76335052
   4.86031726   4.8672687    4.89234049   5.07556159   5.11456812
   5.14417318   5.15764703   5.18565577   5.19722684   5.21292411
   5.24982675   5.2741759    5.33708715   5.38720567   5.47525137
   5.50102924   5.57486261   5.64108168   5.66720224   5.70419783
   5.70843096   5.71251509   5.73003192   5.73900661   5.81232108
   5.83651732   5.86627661   5.86794592   5.96189516   6.27359668
   6.28444469   6.28921717   6.3178575    6.33552411  13.03776075
  13.99300297  14.12197266]
E1 = -321.70872936088386  E_coul = 120.78540942702884
cycle= 2 E= -118.305501266606  delta_E= -0.0265  |g|= 0.0741  |ddm|= 0.201
    CPU time for cycle= 2      0.82 sec, wall time      0.81 sec
  HOMO = -0.461691926104612  LUMO = 0.141652228972827
  mo_energy =
[-11.19406842 -11.19403288 -11.19000783  -1.04403228  -0.92021352
  -0.79384335  -0.61703016  -0.58865923  -0.54472829  -0.52775229
  -0.46891931  -0.46277602  -0.46169193   0.14165223   0.17852171
   0.18534685   0.19225265   0.22137934   0.23421445   0.24361997
   0.26352804   0.29927471   0.37098002   0.38204084   0.38305367
   0.40731708   0.44633602   0.44855291   0.48905848   0.52240153
   0.58752831   0.59308963   0.62383043   0.62972513   0.65054942
   0.66173568   0.68220856   0.68575435   0.68969833   0.70405026
   0.73853944   0.77616933   0.82423983   0.89799023   0.89976826
   0.91939588   0.96629566   0.98169988   1.07599      1.08520712
   1.13210226   1.15852736   1.18259081   1.20319125   1.22925038
   1.24990699   1.28204709   1.30037617   1.31097758   1.32871769
   1.35425604   1.37275286   1.39189575   1.40751968   1.41444537
   1.44825002   1.47047654   1.49109926   1.51785931   1.53978522
   1.55673187   1.58575013   1.61588322   1.62575204   1.64543879
   1.70741491   1.75187626   1.75769936   1.80294628   1.83339217
   1.86837511   1.90847054   2.48434971   2.53753673   2.56572406
   2.61268819   2.64207876   2.68003959   2.74486587   2.76521833
   2.78713724   2.81695584   2.83802702   2.87019137   2.95112183
   2.95795697   2.99126666   3.03325296   3.09390491   3.12057829
   3.14066935   3.14133546   3.14667649   3.16557864   3.22309562
   3.24489515   3.24493401   3.33754649   3.34902768   3.38018433
   3.38265501   3.38340199   3.40654508   3.41431391   3.44246969
   3.47387358   3.48566867   3.50563891   3.52979254   3.58321353
   3.61269462   3.64867288   3.67883963   3.70098072   3.70802307
   3.74707488   3.75101736   3.80132409   3.81035552   3.85911957
   3.86945498   3.91268437   3.91353767   3.94977633   4.05402234
   4.05791334   4.07366315   4.11864746   4.13916473   4.1397142
   4.14748862   4.15737374   4.18378044   4.22734357   4.26632654
   4.27274201   4.27417767   4.30751165   4.34471636   4.350059
   4.37731551   4.42649203   4.45822071   4.46358295   4.4717785
   4.49554034   4.54085391   4.58847937   4.61964324   4.62713893
   4.64918325   4.66212294   4.68529484   4.73177403   4.7846503
   4.88139035   4.8921645    4.91365875   5.09820125   5.13420661
   5.16613788   5.17618146   5.20572507   5.22142316   5.23615921
   5.26994015   5.2982525    5.35979872   5.40967871   5.49493423
   5.52420011   5.59655955   5.66336689   5.69035881   5.72696296
   5.72837154   5.73270312   5.75219078   5.75952522   5.83935706
   5.859807     5.89166859   5.89292282   5.993984     6.29763603
   6.30840844   6.31347423   6.34211492   6.37011862  13.0801741
  14.01943622  14.14654796]
E1 = -321.48560247057503  E_coul = 120.56032419870053
cycle= 3 E= -118.307459604625  delta_E= -0.00196  |g|= 0.0229  |ddm|= 0.0698
    CPU time for cycle= 3      0.82 sec, wall time      0.80 sec
  HOMO = -0.468473206185212  LUMO = 0.140363342786265
  mo_energy =
[-11.21970989 -11.208722   -11.20868812  -1.05335039  -0.92594363
  -0.80036698  -0.62386188  -0.59528701  -0.55130591  -0.53236406
  -0.47713577  -0.47197149  -0.46847321   0.14036334   0.17774971
   0.18412396   0.19086108   0.22016623   0.23268395   0.24280527
   0.26254524   0.29693625   0.36830091   0.38019035   0.38113618
   0.40398404   0.4434877    0.44476387   0.48682281   0.52088192
   0.58332034   0.58867494   0.61931145   0.62584127   0.64702221
   0.65950938   0.67598987   0.68044786   0.68486767   0.69749092
   0.73521111   0.77250385   0.82152296   0.89529844   0.89603599
   0.91659592   0.96368151   0.97915795   1.07117065   1.08369171
   1.13084671   1.15491345   1.17899026   1.20013863   1.22570685
   1.24639109   1.27825109   1.29466224   1.30766201   1.32612251
   1.34872699   1.37087226   1.38702643   1.40459488   1.40841502
   1.44553912   1.46597128   1.48688846   1.51408974   1.53539051
   1.55387114   1.58240404   1.61195421   1.62189163   1.64272156
   1.70367788   1.74706378   1.75426451   1.79917154   1.83011946
   1.86373733   1.90282536   2.48079847   2.53264586   2.5600556
   2.60783563   2.63187415   2.67306113   2.73869778   2.76118436
   2.78160878   2.80962999   2.8272875    2.86040599   2.94338351
   2.94909854   2.98113103   3.02422721   3.08690643   3.11258219
   3.13507175   3.13577344   3.14088167   3.15700715   3.21575317
   3.23718974   3.23946427   3.33098674   3.34277495   3.37347816
   3.37556243   3.37631463   3.39982899   3.40825663   3.43450636
   3.46703695   3.48005451   3.49586999   3.52152537   3.57707837
   3.60635289   3.64700842   3.67595795   3.69614204   3.70189052
   3.74400525   3.74698231   3.79778386   3.80690537   3.85463696
   3.8639578    3.90898673   3.91010326   3.94513811   4.04867022
   4.05448791   4.06944237   4.11597559   4.13150528   4.13499773
   4.14398837   4.15501484   4.18056314   4.21884636   4.26248243
   4.2705875    4.27112654   4.30397315   4.34179631   4.34526065
   4.37502882   4.42578495   4.45433034   4.45850792   4.4712477
   4.49275516   4.5361702    4.58689271   4.61554697   4.62178539
   4.64702766   4.65948271   4.67909508   4.72765704   4.78026985
   4.87619336   4.88663903   4.9082486    5.09152059   5.1300864
   5.15978353   5.17277867   5.2014056    5.21549777   5.22959148
   5.26602992   5.29247266   5.35383701   5.40412805   5.48993131
   5.5184724    5.59048777   5.6578665    5.68512238   5.72169797
   5.72495357   5.72936837   5.74719072   5.75606383   5.83235593
   5.85379404   5.88458241   5.88608764   5.98371567   6.29279762
   6.3034289    6.30822217   6.33698351   6.35989251  13.06265497
  14.00876316  14.13679426]
E1 = -321.60670188523113  E_coul = 120.68128220738559
cycle= 4 E= -118.307601010596  delta_E= -0.000141  |g|= 0.0038  |ddm|= 0.0172
    CPU time for cycle= 4      0.82 sec, wall time      0.80 sec
  HOMO = -0.468111525993584  LUMO = 0.140531125351924
  mo_energy =
[-11.21766449 -11.20815376 -11.20811843  -1.0523437   -0.92546616
  -0.7999075   -0.62326426  -0.59490839  -0.55100339  -0.53212292
  -0.47675419  -0.47160997  -0.46811153   0.14053113   0.17776679
   0.18430282   0.19112009   0.22028662   0.2329228    0.24289639
   0.26270002   0.29716768   0.3684377    0.38028295   0.38120467
   0.40406533   0.44374387   0.44506676   0.48700211   0.5208894
   0.58369343   0.58917811   0.61967153   0.62605439   0.64732715
   0.65948006   0.67664903   0.6807183    0.68530333   0.69781645
   0.73544214   0.77275853   0.82171085   0.89548905   0.89638255
   0.91690948   0.96379769   0.97936266   1.07161275   1.0838039
   1.13091437   1.15526378   1.17920294   1.20033497   1.2258227
   1.24655291   1.27850298   1.2951902    1.30787249   1.32625451
   1.34900129   1.37102443   1.38737336   1.40482375   1.40878454
   1.44575854   1.46620642   1.48731505   1.5144279    1.53577153
   1.55403999   1.58272711   1.6123081    1.62217107   1.64295184
   1.70388276   1.747337     1.75450938   1.79939943   1.83013054
   1.86400267   1.90310153   2.48107502   2.5329724    2.56043861
   2.60800872   2.63271153   2.67363973   2.73911872   2.76133228
   2.7821181    2.8102763    2.82819788   2.86112705   2.94390435
   2.94967335   2.98186843   3.02481453   3.0873835    3.11303815
   3.13527144   3.13604092   3.14117973   3.15774253   3.216128
   3.23755464   3.23958663   3.33135826   3.34320462   3.37398486
   3.37602621   3.37662163   3.40004863   3.40850234   3.4351344
   3.46742875   3.48027142   3.49656616   3.52201125   3.57751039
   3.60680284   3.64696593   3.67599897   3.69629436   3.70242642
   3.74432613   3.74722083   3.79811158   3.80715379   3.855033
   3.86449655   3.90932645   3.91027298   3.94550443   4.04918872
   4.05464546   4.06986725   4.11624077   4.13211442   4.13537277
   4.14441305   4.15505106   4.1809157    4.21939097   4.26276531
   4.2708912    4.27121887   4.30424183   4.34200765   4.34558255
   4.37526032   4.42591783   4.45461888   4.45877998   4.47135481
   4.4929529    4.53642933   4.58705836   4.61590036   4.62227617
   4.6472567    4.65960311   4.67932736   4.72802876   4.78060376
   4.87662107   4.88684977   4.90871911   5.09214674   5.13036405
   5.16017324   5.17306415   5.20173141   5.2159218    5.22992665
   5.26638371   5.29290673   5.35416486   5.4045365    5.49030063
   5.5188909    5.59096496   5.65819331   5.68548018   5.72193461
   5.72499      5.72940836   5.74755484   5.7561055    5.8328041
   5.85425519   5.88508446   5.88665058   5.98445696   6.29284881
   6.30359796   6.30843035   6.3370989    6.36054168  13.06386286
  14.00929499  14.13721727]
E1 = -321.59317483261077  E_coul = 120.66774988723498
cycle= 5 E= -118.307606278127  delta_E= -5.27e-06  |g|= 0.000597  |ddm|= 0.00378
    CPU time for cycle= 5      0.82 sec, wall time      0.80 sec
  HOMO = -0.468093648686456  LUMO = 0.140534088870979
  mo_energy =
[-11.21754503 -11.20795365 -11.20791859  -1.0523463   -0.92543365
  -0.799861    -0.62323687  -0.59487718  -0.55099896  -0.53212242
  -0.47676922  -0.47163241  -0.46809365   0.14053409   0.17778653
   0.18431483   0.1911246    0.22031625   0.23293867   0.24291064
   0.26269561   0.29716701   0.36846351   0.38029347   0.38119692
   0.40408143   0.44373726   0.44505817   0.4870088    0.52088685
   0.58371228   0.58917962   0.61967374   0.62605939   0.6473346
   0.65951038   0.67662004   0.6807602    0.68532495   0.69784903
   0.73546795   0.77279486   0.82169693   0.89547257   0.89636575
   0.91688178   0.96382905   0.97936255   1.07158625   1.08379458
   1.1309063    1.15526527   1.17919864   1.20034198   1.22585457
   1.24655674   1.27853117   1.29517889   1.30789625   1.32627512
   1.34900996   1.37104344   1.38738025   1.40483961   1.40880354
   1.44574661   1.46622629   1.48731891   1.51441865   1.53577402
   1.55408259   1.58271049   1.61232356   1.62219181   1.64292532
   1.70389896   1.7473997    1.75451949   1.79941863   1.83018824
   1.86402573   1.90315302   2.48106092   2.53299301   2.56048673
   2.60807063   2.63270766   2.67363943   2.73912231   2.76134896
   2.782132     2.81027592   2.8282014    2.86115287   2.94393434
   2.94971459   2.98189082   3.02486786   3.08739259   3.11308689
   3.13532116   3.13602926   3.14119125   3.15774026   3.21617211
   3.23759534   3.23962822   3.33136746   3.34322708   3.3739949
   3.37605312   3.37667643   3.40009336   3.40853022   3.43515475
   3.46748741   3.48033166   3.49658769   3.52205117   3.57753606
   3.60682358   3.647005     3.67603874   3.69637577   3.70244013
   3.74430562   3.74726444   3.79811017   3.80717687   3.85506538
   3.86448725   3.90933496   3.9103214    3.94552166   4.04922395
   4.05471014   4.06989844   4.11625432   4.13214995   4.13541089
   4.14443035   4.15512089   4.18091144   4.21945905   4.262832
   4.27088483   4.27128751   4.30425823   4.34206686   4.34561419
   4.37528697   4.42593662   4.45465643   4.45885129   4.47138137
   4.49297989   4.53647901   4.58710209   4.61591624   4.62231095
   4.64729092   4.65967541   4.67939701   4.72805608   4.78066403
   4.87664175   4.88691795   4.9087613    5.09214574   5.13040741
   5.16019958   5.17307836   5.20175214   5.21598692   5.22997784
   5.26639834   5.29296066   5.35423035   5.4045678    5.49030618
   5.51894161   5.59095954   5.65823983   5.68551312   5.72200934
   5.72505272   5.72946479   5.74757255   5.75617665   5.83286734
   5.85428421   5.88511138   5.88667223   5.98451238   6.29294067
   6.30363244   6.30846406   6.33718377   6.3606037   13.06394272
  14.00939943  14.13732713]
E1 = -321.59220669496756  E_coul = 120.66678152821697
cycle= 6 E= -118.307606499502  delta_E= -2.21e-07  |g|= 0.00015  |ddm|= 0.00114
    CPU time for cycle= 6      0.82 sec, wall time      0.80 sec
  HOMO = -0.468103936186816  LUMO = 0.140528127258539
  mo_energy =
[-11.21755739 -11.2080392  -11.20800393  -1.05237778  -0.92546789
  -0.79988941  -0.6232451   -0.59490556  -0.55102305  -0.53213101
  -0.47679435  -0.47167338  -0.46810394   0.14052813   0.17777791
   0.18431231   0.19112568   0.22030819   0.23293936   0.24290808
   0.26269697   0.29716369   0.36845688   0.38028245   0.38119146
   0.40406072   0.44373133   0.44504619   0.48700337   0.52088122
   0.58369922   0.58917487   0.61966116   0.62604376   0.64732581
   0.65949262   0.6766068    0.68074484   0.68531819   0.69782574
   0.7354593    0.77278369   0.82168763   0.89546434   0.89635346
   0.91688015   0.96381392   0.97935741   1.07157265   1.08378921
   1.1309015    1.15525554   1.17918907   1.20033068   1.22583926
   1.24654369   1.2785157    1.29517038   1.30788629   1.32626711
   1.34899462   1.37103974   1.38736814   1.40482965   1.4087859
   1.44574394   1.46621107   1.48731112   1.51440887   1.53576142
   1.55406835   1.58269947   1.61231656   1.62218088   1.64291788
   1.70388688   1.74738525   1.75450918   1.79941016   1.83017177
   1.86401005   1.90313858   2.48105723   2.53298531   2.56046197
   2.60804626   2.63267933   2.67362145   2.73910707   2.76133511
   2.78212295   2.8102616    2.82817757   2.86112634   2.94390904
   2.94968756   2.98186806   3.02483919   3.08737354   3.11305989
   3.13529646   3.13600894   3.14117196   3.15771364   3.21614255
   3.23757068   3.23961452   3.33135003   3.34320108   3.37397055
   3.37602938   3.37664803   3.40006687   3.40850948   3.43513332
   3.46746836   3.4803062    3.4965701    3.5220384    3.57752792
   3.60680902   3.64700003   3.67603005   3.69634872   3.70242722
   3.74430596   3.74724487   3.79810413   3.807161     3.85506034
   3.86447616   3.90932621   3.91030803   3.94551109   4.04921089
   4.05469521   4.06989503   4.11625094   4.13213265   4.13540808
   4.14443041   4.1551106    4.18091067   4.21944237   4.26281673
   4.27088614   4.27127884   4.30425639   4.3420598    4.34560089
   4.37528789   4.42594089   4.4546448    4.45883569   4.47138435
   4.49297714   4.53646714   4.58710225   4.61590979   4.62230196
   4.64729035   4.65966308   4.67937849   4.7280523    4.78065295
   4.87663071   4.88690618   4.90875133   5.09213038   5.13039529
   5.16018161   5.17307222   5.20174145   5.21597284   5.22996163
   5.26639353   5.29295155   5.35420614   5.40455424   5.49028671
   5.51892014   5.59094389   5.65822204   5.68550457   5.72198701
   5.72503935   5.72945415   5.74756679   5.75616329   5.83285312
   5.85427149   5.88509755   5.88666051   5.98449059   6.29291461
   6.30362112   6.30845284   6.3371576    6.36058962  13.06392617
  14.00935005  14.13727571]
E1 = -321.5923676122889  E_coul = 120.6669424325886
cycle= 7 E= -118.307606512451  delta_E= -1.29e-08  |g|= 2.95e-05  |ddm|= 0.000346
    CPU time for cycle= 7      0.83 sec, wall time      0.81 sec
  HOMO = -0.468105639309418  LUMO = 0.140527347130239
  mo_energy =
[-11.21758925 -11.20802504 -11.20798988  -1.05238064  -0.92546748
  -0.7998932   -0.62324584  -0.59490403  -0.55102261  -0.5321298
  -0.4767959   -0.47167306  -0.46810564   0.14052735   0.17777737
   0.18431142   0.19112531   0.22030853   0.23293965   0.24290795
   0.26269613   0.29716209   0.36845526   0.38028305   0.3811899
   0.40406066   0.44373108   0.44504579   0.48700316   0.52087982
   0.58369912   0.58917423   0.61966063   0.62604202   0.64732659
   0.65949265   0.67660432   0.68074301   0.68531812   0.69782433
   0.735459     0.77278367   0.82168707   0.89546321   0.89635296
   0.91687851   0.96381457   0.97935629   1.07157254   1.08378838
   1.13090064   1.15525537   1.17918758   1.20033151   1.22583843
   1.2465431    1.27851571   1.2951685    1.3078853    1.32626649
   1.34899214   1.37103914   1.38736682   1.40482922   1.40878358
   1.44574149   1.46620984   1.48731084   1.51440825   1.53576176
   1.55406887   1.58269917   1.61231522   1.62218057   1.64291724
   1.70388639   1.74738353   1.75450915   1.79940885   1.83017217
   1.8640087    1.90313576   2.48105609   2.53298252   2.56046255
   2.60804721   2.63267766   2.67362008   2.73910551   2.76133516
   2.78212086   2.81025812   2.82817543   2.86112405   2.94390974
   2.94968654   2.98186508   3.02483871   3.0873726    3.11305927
   3.1352983    3.13601054   3.14117242   3.15771338   3.21614311
   3.2375694    3.23961326   3.33134958   3.34320337   3.37397173
   3.37602937   3.37664878   3.40006727   3.40850975   3.43513252
   3.46746627   3.48030887   3.49656348   3.52203289   3.57752487
   3.6068064    3.64699919   3.67602884   3.69635006   3.70242578
   3.74430444   3.74724606   3.79810394   3.80716218   3.85505769
   3.86447476   3.90932582   3.91030811   3.9455102    4.0492102
   4.05469585   4.06989358   4.11625019   4.13213158   4.13540503
   4.14442891   4.15511029   4.18090958   4.21943793   4.26281699
   4.2708835    4.27127973   4.30425365   4.34205928   4.34559858
   4.37528639   4.42593975   4.45464418   4.45883447   4.47138347
   4.4929759    4.53646549   4.58710151   4.6159087    4.62230053
   4.64728905   4.65966322   4.67937804   4.72805064   4.78065253
   4.87662962   4.88690376   4.90874997   5.09212864   5.13039524
   5.16018046   5.17307204   5.20174116   5.21597117   5.22995925
   5.26639237   5.2929493    5.35420649   5.40455361   5.49028787
   5.51892196   5.5909429    5.65822226   5.68550341   5.72198842
   5.72504043   5.72945485   5.74756537   5.75616425   5.83284983
   5.85427024   5.88509614   5.88665795   5.98448608   6.29291829
   6.3036219    6.30845328   6.33716118   6.3605816   13.06391051
  14.00935562  14.13728316]
E1 = -321.5923608999032  E_coul = 120.66693571989833
cycle= 8 E= -118.307606512756  delta_E= -3.05e-10  |g|= 6.37e-06  |ddm|= 4.88e-05
    CPU time for cycle= 8      0.83 sec, wall time      0.80 sec
  HOMO = -0.468105970626084  LUMO = 0.140526951487793
  mo_energy =
[-11.21758592 -11.20803162 -11.20799643  -1.05238185  -0.92546967
  -0.79989397  -0.62324648  -0.59490541  -0.55102428  -0.53213205
  -0.47679666  -0.47167441  -0.46810597   0.14052695   0.17777694
   0.18431122   0.19112499   0.22030821   0.23293954   0.24290744
   0.26269542   0.29716144   0.3684547    0.38028262   0.38118945
   0.40406055   0.44373063   0.4450452    0.48700267   0.52087892
   0.58369858   0.58917397   0.61965948   0.62604101   0.64732526
   0.65949128   0.67660306   0.68074291   0.68531724   0.69782343
   0.73545833   0.77278297   0.82168611   0.89546249   0.89635252
   0.91687781   0.96381392   0.9793557    1.07157122   1.08378759
   1.13089976   1.15525484   1.17918652   1.20033031   1.22583769
   1.246542     1.27851517   1.29516789   1.307885     1.3262658
   1.34899113   1.37103895   1.38736603   1.40482878   1.40878301
   1.44574085   1.46620891   1.4873101    1.51440716   1.53576036
   1.55406849   1.58269812   1.61231497   1.6221797    1.64291594
   1.70388524   1.7473834    1.75450819   1.79940774   1.83017039
   1.86400819   1.90313536   2.48105423   2.53298199   2.56046155
   2.60804589   2.63267624   2.67361884   2.73910409   2.76133332
   2.78212039   2.81025783   2.82817363   2.86112303   2.94390787
   2.94968492   2.98186353   3.02483746   3.08737111   3.11305786
   3.13529593   3.13600825   3.14117046   3.15771203   3.21614148
   3.23756781   3.23961157   3.33134756   3.3432012    3.37396988
   3.37602794   3.37664688   3.40006521   3.40850768   3.43513103
   3.46746585   3.48030638   3.49656354   3.52203299   3.57752407
   3.60680544   3.64699783   3.67602753   3.69634911   3.70242473
   3.74430268   3.74724466   3.7981022    3.8071606    3.85505766
   3.86447347   3.90932454   3.91030702   3.94550924   4.04920935
   4.05469517   4.06989313   4.11624905   4.1321302    4.13540397
   4.14442822   4.15510947   4.18090821   4.21943749   4.26281666
   4.27088205   4.27127884   4.30425262   4.34205908   4.34559807
   4.37528549   4.42593858   4.45464329   4.4588342    4.47138239
   4.49297485   4.53646447   4.58710094   4.61590738   4.6223002
   4.64728849   4.6596624    4.67937613   4.7280497    4.78065193
   4.87662861   4.88690271   4.90874924   5.09212802   5.13039383
   5.1601792    5.17307026   5.20173941   5.21597098   5.22995833
   5.26639093   5.29294911   5.35420522   5.40455205   5.49028601
   5.51892001   5.59094142   5.65822071   5.68550204   5.72198686
   5.72503862   5.72945297   5.74756363   5.75616256   5.83285009
   5.85426917   5.88509425   5.88665726   5.98448572   6.2929159
   6.30361914   6.30845065   6.33715876   6.36058264  13.06391185
  14.00935187  14.13727897]
E1 = -321.5923809134172  E_coul = 120.66695573339986
Extra cycle  E= -118.307606512768  delta_E= -1.24e-11  |g|= 2.58e-06  |ddm|= 8.13e-06
    CPU time for scf_cycle     12.62 sec, wall time     12.45 sec
    CPU time for SCF     12.62 sec, wall time     12.45 sec
converged SCF energy = -118.307606512768
